<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>任务管理看板 - 现代化设计</title>
    
    <style>
        /* ========================================
           🎨 全局样式变量定义
           定义整个应用的颜色主题、间距、动画时长等
           ======================================== */
        :root {
            /* 主题色 - 紫蓝渐变色系 */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            
            /* 基础颜色 */
            --bg-primary: #0f0f1e;
            --bg-secondary: #1a1a2e;
            --bg-card: rgba(255, 255, 255, 0.05);
            --bg-glass: rgba(255, 255, 255, 0.1);
            
            /* 文字颜色 */
            --text-primary: #ffffff;
            --text-secondary: #b8bcc8;
            --text-muted: #6c7293;
            
            /* 状态颜色 */
            --status-todo: #6366f1;
            --status-doing: #f59e0b;
            --status-done: #10b981;
            
            /* 优先级颜色 */
            --priority-high: #ef4444;
            --priority-medium: #f59e0b;
            --priority-low: #10b981;
            
            /* 其他样式变量 */
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.2);
            
            /* 玻璃效果 */
            --glass-blur: blur(10px);
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* ========================================
           📐 基础重置和全局样式
           ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }

        /* 动态背景装饰 */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 20%, rgba(245, 87, 108, 0.1) 0%, transparent 50%);
            animation: backgroundAnimation 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundAnimation {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        /* ========================================
           🗂️ 顶部导航栏样式
           包含 Logo、标题、搜索框和用户信息
           ======================================== */
        .navbar {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border-bottom: var(--glass-border);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: var(--transition);
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .navbar-logo {
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: var(--shadow-md);
        }

        .navbar-title {
            font-size: 1.5rem;
            font-weight: 600;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* 搜索框样式 */
        .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 2rem;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            background: var(--bg-glass);
            border: var(--glass-border);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            font-size: 0.95rem;
            outline: none;
            transition: var(--transition);
        }

        .search-input:focus {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.5);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        /* 用户信息区域 */
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* ========================================
           📊 主体布局 - 三栏式设计
           ======================================== */
        .main-container {
            display: grid;
            grid-template-columns: 250px 1fr 350px;
            gap: 1.5rem;
            padding: 1.5rem;
            height: calc(100vh - 72px);
        }

        /* ========================================
           📁 左侧边栏 - 任务分类导航
           ======================================== */
        .sidebar {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .sidebar-title {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }

        /* 导航菜单项 */
        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: var(--primary-gradient);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .nav-item:hover {
            transform: translateX(5px);
        }

        .nav-item:hover::before {
            width: 100%;
        }

        .nav-item.active {
            background: var(--primary-gradient);
            box-shadow: var(--shadow-md);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-count {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.125rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* 项目列表 */
        .project-list {
            margin-top: 1rem;
        }

        .project-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 0.25rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .project-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .project-color {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* ========================================
           📋 中间区域 - 任务看板
           ======================================== */
        .board-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            overflow-y: auto;
            padding: 0.5rem;
        }

        /* 看板列 */
        .board-column {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            min-height: 500px;
            transition: var(--transition);
        }

        .board-column.drag-over {
            background: rgba(102, 126, 234, 0.1);
            border-color: var(--status-todo);
        }

        .column-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .column-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .column-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .column-icon.todo { background: var(--status-todo); }
        .column-icon.doing { background: var(--status-doing); }
        .column-icon.done { background: var(--status-done); }

        .column-count {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
        }

        /* 添加任务按钮 */
        .add-task-btn {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .add-task-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.4);
            color: var(--text-primary);
        }

        /* 任务卡片容器 */
        .tasks-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* ========================================
           🃏 任务卡片样式
           ======================================== */
        .task-card {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: var(--border-radius-sm);
            padding: 1rem;
            cursor: grab;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: rgba(255, 255, 255, 0.15);
        }

        .task-card.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        /* 优先级指示条 */
        .task-priority-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .task-priority-bar.high { background: var(--priority-high); }
        .task-priority-bar.medium { background: var(--priority-medium); }
        .task-priority-bar.low { background: var(--priority-low); }

        /* 任务头部 */
        .task-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .task-type-icon {
            width: 32px;
            height: 32px;
            background: var(--primary-gradient);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .task-menu {
            opacity: 0;
            transition: opacity 0.2s;
            cursor: pointer;
            color: var(--text-muted);
        }

        .task-card:hover .task-menu {
            opacity: 1;
        }

        /* 任务内容 */
        .task-content {
            margin-left: 40px;
        }

        .task-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .task-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* 任务标签 */
        .task-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .task-tag {
            background: rgba(102, 126, 234, 0.2);
            color: #a5b4fc;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* 任务底部信息 */
        .task-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 0.75rem;
        }

        .task-date {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .task-date.overdue {
            color: var(--priority-high);
        }

        /* 进度条 */
        .task-progress {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .task-progress-bar {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* ========================================
           📝 右侧边栏 - 任务详情面板
           ======================================== */
        .detail-panel {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            overflow-y: auto;
            transition: var(--transition);
        }

        .detail-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .detail-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .detail-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .detail-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        /* 详情内容区域 */
        .detail-section {
            margin-bottom: 2rem;
        }

        .detail-section-title {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }

        .detail-field {
            margin-bottom: 1rem;
        }

        .detail-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .detail-value {
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
        }

        /* 操作按钮 */
        .detail-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: var(--glass-border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* ========================================
           📊 统计图表区域
           ======================================== */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: var(--border-radius-sm);
            padding: 1rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* ========================================
           🎯 模态框样式
           ======================================== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: var(--glass-border);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-glass);
            border: var(--glass-border);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            font-size: 0.95rem;
            outline: none;
            transition: var(--transition);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.5);
        }

        /* 标签输入 */
        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--bg-glass);
            border: var(--glass-border);
            border-radius: var(--border-radius-sm);
            min-height: 44px;
        }

        .tag-input-item {
            background: var(--primary-gradient);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-remove {
            cursor: pointer;
            font-size: 1rem;
            line-height: 1;
        }

        /* ========================================
           📱 响应式设计
           ======================================== */
        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 200px 1fr 300px;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar,
            .detail-panel {
                display: none;
            }
            
            .board-container {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 1rem;
            }
            
            .search-container {
                display: none;
            }
            
            .board-container {
                grid-template-columns: 1fr;
            }
        }

        /* ========================================
           🎭 动画效果
           ======================================== */
        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .slide-in-right {
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top-color: var(--text-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========================================
           🛠️ 工具类
           ======================================== */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-muted { color: var(--text-muted); }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
    </style>
</head>
<body>
    <!-- ========================================
         🎯 顶部导航栏
         包含应用 Logo、标题、全局搜索和用户信息
         ======================================== -->
    <nav class="navbar">
        <div class="navbar-brand">
            <div class="navbar-logo">📋</div>
            <h1 class="navbar-title">任务管理看板</h1>
        </div>
        
        <div class="search-container">
            <span class="search-icon">🔍</span>
            <input type="text" class="search-input" placeholder="搜索任务、项目或标签...">
        </div>
        
        <div class="user-info">
            <button class="btn btn-primary" onclick="showCreateTaskModal()">
                <span>➕</span>
                <span>新建任务</span>
            </button>
            <div class="user-avatar">U</div>
        </div>
    </nav>

    <!-- ========================================
         📊 主体内容区域 - 三栏布局
         ======================================== -->
    <div class="main-container">
        <!-- ========================================
             📁 左侧边栏 - 任务分类和项目导航
             ======================================== -->
        <aside class="sidebar">
            <!-- 快速导航 -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">快速导航</h3>
                <div class="nav-item active">
                    <span class="nav-icon">📅</span>
                    <span>今日任务</span>
                    <span class="nav-count">5</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">⭐</span>
                    <span>重要任务</span>
                    <span class="nav-count">3</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">📌</span>
                    <span>已加星标</span>
                    <span class="nav-count">2</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">✅</span>
                    <span>已完成</span>
                    <span class="nav-count">12</span>
                </div>
            </div>
            
            <!-- 项目列表 -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">我的项目</h3>
                <div class="project-list">
                    <div class="project-item">
                        <span class="project-color" style="background: #667eea;"></span>
                        <span>网站重构</span>
                    </div>
                    <div class="project-item">
                        <span class="project-color" style="background: #f59e0b;"></span>
                        <span>移动应用开发</span>
                    </div>
                    <div class="project-item">
                        <span class="project-color" style="background: #10b981;"></span>
                        <span>市场营销计划</span>
                    </div>
                    <div class="project-item">
                        <span class="project-color" style="background: #ef4444;"></span>
                        <span>产品设计</span>
                    </div>
                </div>
            </div>
            
            <!-- 标签过滤 -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">标签</h3>
                <div class="nav-item">
                    <span class="nav-icon">🏷️</span>
                    <span>前端开发</span>
                    <span class="nav-count">8</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">🏷️</span>
                    <span>设计</span>
                    <span class="nav-count">4</span>
                </div>
                <div class="nav-item">
                    <span class="nav-icon">🏷️</span>
                    <span>会议</span>
                    <span class="nav-count">2</span>
                </div>
            </div>
        </aside>

        <!-- ========================================
             📋 中间区域 - 看板视图
             包含待办、进行中、已完成三个列
             ======================================== -->
        <main class="board-container">
            <!-- 待办列 -->
            <div class="board-column" data-status="todo" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                <div class="column-header">
                    <div class="column-title">
                        <span class="column-icon todo">📝</span>
                        <span>待办事项</span>
                    </div>
                    <span class="column-count">4</span>
                </div>
                
                <button class="add-task-btn" onclick="showCreateTaskModal('todo')">
                    <span>➕</span>
                    <span>添加任务</span>
                </button>
                
                <div class="tasks-container" id="todo-tasks">
                    <!-- 示例任务卡片 1 -->
                    <div class="task-card" draggable="true" ondragstart="handleDragStart(event)" data-task-id="1">
                        <div class="task-priority-bar high"></div>
                        <div class="task-header">
                            <div class="task-type-icon">🎯</div>
                            <div class="task-menu">⋮</div>
                        </div>
                        <div class="task-content">
                            <h3 class="task-title">完成项目原型设计</h3>
                            <p class="task-description">使用 Figma 设计新版本的用户界面原型，包含主要页面和交互流程</p>
                            <div class="task-tags">
                                <span class="task-tag">设计</span>
                                <span class="task-tag">高优先级</span>
                            </div>
                            <div class="task-footer">
                                <span class="task-date overdue">
                                    <span>📅</span>
                                    <span>已逾期 2 天</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 示例任务卡片 2 -->
                    <div class="task-card" draggable="true" ondragstart="handleDragStart(event)" data-task-id="2">
                        <div class="task-priority-bar medium"></div>
                        <div class="task-header">
                            <div class="task-type-icon">💻</div>
                            <div class="task-menu">⋮</div>
                        </div>
                        <div class="task-content">
                            <h3 class="task-title">实现用户认证功能</h3>
                            <p class="task-description">开发登录、注册、忘记密码等认证相关功能模块</p>
                            <div class="task-tags">
                                <span class="task-tag">前端开发</span>
                                <span class="task-tag">功能开发</span>
                            </div>
                            <div class="task-footer">
                                <span class="task-date">
                                    <span>📅</span>
                                    <span>明天到期</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 进行中列 -->
            <div class="board-column" data-status="doing" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                <div class="column-header">
                    <div class="column-title">
                        <span class="column-icon doing">🚀</span>
                        <span>进行中</span>
                    </div>
                    <span class="column-count">2</span>
                </div>
                
                <button class="add-task-btn" onclick="showCreateTaskModal('doing')">
                    <span>➕</span>
                    <span>添加任务</span>
                </button>
                
                <div class="tasks-container" id="doing-tasks">
                    <!-- 示例任务卡片 3 -->
                    <div class="task-card" draggable="true" ondragstart="handleDragStart(event)" data-task-id="3">
                        <div class="task-priority-bar high"></div>
                        <div class="task-header">
                            <div class="task-type-icon">📊</div>
                            <div class="task-menu">⋮</div>
                        </div>
                        <div class="task-content">
                            <h3 class="task-title">数据报表开发</h3>
                            <p class="task-description">使用 ECharts 开发数据可视化报表，展示关键业务指标</p>
                            <div class="task-tags">
                                <span class="task-tag">数据可视化</span>
                                <span class="task-tag">前端开发</span>
                            </div>
                            <div class="task-progress">
                                <div class="task-progress-bar" style="width: 65%;"></div>
                            </div>
                            <div class="task-footer">
                                <span class="task-date">
                                    <span>📅</span>
                                    <span>本周五到期</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 已完成列 -->
            <div class="board-column" data-status="done" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                <div class="column-header">
                    <div class="column-title">
                        <span class="column-icon done">✅</span>
                        <span>已完成</span>
                    </div>
                    <span class="column-count">3</span>
                </div>
                
                <div class="tasks-container" id="done-tasks">
                    <!-- 示例任务卡片 4 -->
                    <div class="task-card" draggable="true" ondragstart="handleDragStart(event)" data-task-id="4">
                        <div class="task-priority-bar low"></div>
                        <div class="task-header">
                            <div class="task-type-icon">📝</div>
                            <div class="task-menu">⋮</div>
                        </div>
                        <div class="task-content">
                            <h3 class="task-title">编写技术文档</h3>
                            <p class="task-description">完成 API 接口文档和开发指南的编写工作</p>
                            <div class="task-tags">
                                <span class="task-tag">文档</span>
                            </div>
                            <div class="task-footer">
                                <span class="task-date">
                                    <span>✅</span>
                                    <span>昨天完成</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- ========================================
             📝 右侧边栏 - 任务详情面板
             ======================================== -->
        <aside class="detail-panel hidden" id="detailPanel">
            <div class="detail-header">
                <h2 class="detail-title">任务详情</h2>
                <div class="detail-close" onclick="hideDetailPanel()">✕</div>
            </div>
            
            <!-- 统计概览 -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value">12</div>
                    <div class="stat-label">本周完成</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">85%</div>
                    <div class="stat-label">完成率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">3</div>
                    <div class="stat-label">逾期任务</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">24</div>
                    <div class="stat-label">总任务数</div>
                </div>
            </div>
            
            <!-- 任务详情内容 -->
            <div class="detail-section">
                <h3 class="detail-section-title">基本信息</h3>
                <div class="detail-field">
                    <div class="detail-label">任务标题</div>
                    <div class="detail-value" id="detailTitle">-</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">任务描述</div>
                    <div class="detail-value" id="detailDescription">-</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">优先级</div>
                    <div class="detail-value" id="detailPriority">-</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">截止日期</div>
                    <div class="detail-value" id="detailDueDate">-</div>
                </div>
            </div>
            
            <!-- 操作按钮 -->
            <div class="detail-actions">
                <button class="btn btn-primary">
                    <span>📝</span>
                    <span>编辑</span>
                </button>
                <button class="btn btn-secondary">
                    <span>🗑️</span>
                    <span>删除</span>
                </button>
            </div>
        </aside>
    </div>

    <!-- ========================================
         🎯 创建任务模态框
         ======================================== -->
    <div class="modal" id="createTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">创建新任务</h2>
                <div class="detail-close" onclick="hideCreateTaskModal()">✕</div>
            </div>
            
            <form id="createTaskForm">
                <div class="form-group">
                    <label class="form-label">任务标题</label>
                    <input type="text" class="form-input" id="taskTitle" placeholder="输入任务标题..." required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">任务描述</label>
                    <textarea class="form-textarea" id="taskDescription" placeholder="详细描述任务内容..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">任务类型</label>
                    <select class="form-select" id="taskType">
                        <option value="task">🎯 目标</option>
                        <option value="project">📁 项目</option>
                        <option value="feature">💻 功能</option>
                        <option value="bug">🐛 缺陷</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">优先级</label>
                    <select class="form-select" id="taskPriority">
                        <option value="high">🔴 高优先级</option>
                        <option value="medium">🟡 中优先级</option>
                        <option value="low">🟢 低优先级</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">截止日期</label>
                    <input type="date" class="form-input" id="taskDueDate">
                </div>
                
                <div class="form-group">
                    <label class="form-label">标签</label>
                    <div class="tag-input-container" id="tagInputContainer">
                        <input type="text" class="form-input" id="tagInput" placeholder="输入标签后按回车..." style="border: none; background: none; flex: 1; min-width: 120px;">
                    </div>
                </div>
                
                <div class="detail-actions">
                    <button type="submit" class="btn btn-primary">
                        <span>✅</span>
                        <span>创建任务</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="hideCreateTaskModal()">
                        <span>❌</span>
                        <span>取消</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        /* ========================================
           🎯 任务管理看板 - JavaScript 逻辑
           
           功能模块：
           1. 任务数据管理
           2. 拖拽功能实现
           3. 模态框控制
           4. 任务的增删改查
           5. 数据持久化
           6. 与 MNTask 插件通信
           ======================================== */

        // ========================================
        // 📊 任务数据管理
        // ========================================
        
        // 任务数据存储对象
        let tasksData = {
            todo: [],
            doing: [],
            done: []
        };

        // 当前选中的任务
        let selectedTask = null;

        // 初始化示例数据
        function initializeSampleData() {
            // 这里可以从 localStorage 或插件加载数据
            console.log('✅ 任务看板初始化完成');
        }

        // ========================================
        // 🎯 拖拽功能实现
        // ========================================
        
        // 拖拽开始
        function handleDragStart(e) {
            const taskCard = e.target.closest('.task-card');
            if (!taskCard) return;
            
            // 添加拖拽中的样式
            taskCard.classList.add('dragging');
            
            // 存储拖拽的任务ID
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('taskId', taskCard.dataset.taskId);
            
            console.log('🎯 开始拖拽任务:', taskCard.dataset.taskId);
        }

        // 拖拽经过
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            // 添加拖拽悬停效果
            const column = e.target.closest('.board-column');
            if (column) {
                column.classList.add('drag-over');
            }
        }

        // 拖拽离开
        function handleDragLeave(e) {
            const column = e.target.closest('.board-column');
            if (column) {
                column.classList.remove('drag-over');
            }
        }

        // 拖拽放下
        function handleDrop(e) {
            e.preventDefault();
            
            const column = e.target.closest('.board-column');
            if (!column) return;
            
            // 移除拖拽效果
            column.classList.remove('drag-over');
            
            // 获取拖拽的任务ID和目标状态
            const taskId = e.dataTransfer.getData('taskId');
            const newStatus = column.dataset.status;
            
            // 移动任务到新列
            moveTaskToColumn(taskId, newStatus);
            
            console.log('✅ 任务已移动到:', newStatus);
        }

        // 拖拽结束
        document.addEventListener('dragend', (e) => {
            if (e.target.classList.contains('task-card')) {
                e.target.classList.remove('dragging');
            }
        });

        // 移动任务到新列
        function moveTaskToColumn(taskId, newStatus) {
            // 找到任务卡片
            const taskCard = document.querySelector(`[data-task-id="${taskId}"]`);
            if (!taskCard) return;
            
            // 找到目标容器
            const targetContainer = document.getElementById(`${newStatus}-tasks`);
            if (!targetContainer) return;
            
            // 移动卡片
            targetContainer.appendChild(taskCard);
            
            // 更新数据（这里需要实现数据更新逻辑）
            updateTaskStatus(taskId, newStatus);
            
            // 更新列计数
            updateColumnCounts();
        }

        // 更新任务状态
        function updateTaskStatus(taskId, newStatus) {
            // 发送消息到插件
            sendToPlugin('updateTaskStatus', {
                taskId: taskId,
                status: newStatus
            });
            
            // 更新本地数据
            // TODO: 实现数据更新逻辑
        }

        // 更新列计数
        function updateColumnCounts() {
            const columns = ['todo', 'doing', 'done'];
            columns.forEach(status => {
                const container = document.getElementById(`${status}-tasks`);
                const count = container.children.length;
                const countElement = container.closest('.board-column').querySelector('.column-count');
                countElement.textContent = count;
            });
        }

        // ========================================
        // 🎯 模态框控制
        // ========================================
        
        // 显示创建任务模态框
        function showCreateTaskModal(defaultStatus = 'todo') {
            const modal = document.getElementById('createTaskModal');
            modal.classList.add('active');
            
            // 设置默认状态
            document.getElementById('taskStatus')?.value = defaultStatus;
            
            // 聚焦到标题输入框
            setTimeout(() => {
                document.getElementById('taskTitle').focus();
            }, 100);
        }

        // 隐藏创建任务模态框
        function hideCreateTaskModal() {
            const modal = document.getElementById('createTaskModal');
            modal.classList.remove('active');
            
            // 重置表单
            document.getElementById('createTaskForm').reset();
            clearTags();
        }

        // 显示任务详情面板
        function showDetailPanel(taskId) {
            const panel = document.getElementById('detailPanel');
            panel.classList.remove('hidden');
            panel.classList.add('slide-in-right');
            
            // 加载任务详情
            loadTaskDetail(taskId);
        }

        // 隐藏任务详情面板
        function hideDetailPanel() {
            const panel = document.getElementById('detailPanel');
            panel.classList.add('hidden');
        }

        // ========================================
        // 📝 任务创建和编辑
        // ========================================
        
        // 标签管理
        let currentTags = [];

        // 标签输入处理
        document.getElementById('tagInput')?.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                const input = e.target;
                const tag = input.value.trim();
                
                if (tag && !currentTags.includes(tag)) {
                    addTag(tag);
                    input.value = '';
                }
            }
        });

        // 添加标签
        function addTag(tag) {
            currentTags.push(tag);
            
            const tagElement = document.createElement('div');
            tagElement.className = 'tag-input-item';
            tagElement.innerHTML = `
                <span>${tag}</span>
                <span class="tag-remove" onclick="removeTag('${tag}')">×</span>
            `;
            
            const container = document.getElementById('tagInputContainer');
            const input = document.getElementById('tagInput');
            container.insertBefore(tagElement, input);
        }

        // 移除标签
        function removeTag(tag) {
            currentTags = currentTags.filter(t => t !== tag);
            
            // 移除DOM元素
            const container = document.getElementById('tagInputContainer');
            const tags = container.querySelectorAll('.tag-input-item');
            tags.forEach(element => {
                if (element.textContent.includes(tag)) {
                    element.remove();
                }
            });
        }

        // 清空标签
        function clearTags() {
            currentTags = [];
            const container = document.getElementById('tagInputContainer');
            const tags = container.querySelectorAll('.tag-input-item');
            tags.forEach(tag => tag.remove());
        }

        // 创建任务表单提交
        document.getElementById('createTaskForm')?.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // 收集表单数据
            const taskData = {
                id: Date.now().toString(),
                title: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                type: document.getElementById('taskType').value,
                priority: document.getElementById('taskPriority').value,
                dueDate: document.getElementById('taskDueDate').value,
                tags: [...currentTags],
                status: 'todo',
                createdAt: new Date().toISOString()
            };
            
            // 创建任务
            createTask(taskData);
            
            // 隐藏模态框
            hideCreateTaskModal();
            
            // 显示成功提示
            showNotification('✅ 任务创建成功！');
        });

        // 创建任务
        function createTask(taskData) {
            // 创建任务卡片HTML
            const taskCardHTML = createTaskCardHTML(taskData);
            
            // 添加到对应的列
            const container = document.getElementById(`${taskData.status}-tasks`);
            container.insertAdjacentHTML('beforeend', taskCardHTML);
            
            // 更新列计数
            updateColumnCounts();
            
            // 发送到插件
            sendToPlugin('createTask', taskData);
        }

        // 创建任务卡片HTML
        function createTaskCardHTML(task) {
            const priorityClass = task.priority || 'medium';
            const typeIcon = getTaskTypeIcon(task.type);
            const tagsHTML = task.tags.map(tag => `<span class="task-tag">${tag}</span>`).join('');
            
            return `
                <div class="task-card fade-in" draggable="true" ondragstart="handleDragStart(event)" data-task-id="${task.id}">
                    <div class="task-priority-bar ${priorityClass}"></div>
                    <div class="task-header">
                        <div class="task-type-icon">${typeIcon}</div>
                        <div class="task-menu" onclick="showTaskMenu(event, '${task.id}')">⋮</div>
                    </div>
                    <div class="task-content" onclick="showDetailPanel('${task.id}')">
                        <h3 class="task-title">${task.title}</h3>
                        <p class="task-description">${task.description}</p>
                        ${tagsHTML ? `<div class="task-tags">${tagsHTML}</div>` : ''}
                        <div class="task-footer">
                            <span class="task-date">
                                <span>📅</span>
                                <span>${formatDueDate(task.dueDate)}</span>
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }

        // 获取任务类型图标
        function getTaskTypeIcon(type) {
            const icons = {
                task: '🎯',
                project: '📁',
                feature: '💻',
                bug: '🐛'
            };
            return icons[type] || '📋';
        }

        // 格式化截止日期
        function formatDueDate(dateString) {
            if (!dateString) return '无截止日期';
            
            const date = new Date(dateString);
            const today = new Date();
            const diffTime = date - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) {
                return `已逾期 ${Math.abs(diffDays)} 天`;
            } else if (diffDays === 0) {
                return '今天到期';
            } else if (diffDays === 1) {
                return '明天到期';
            } else if (diffDays <= 7) {
                return `${diffDays} 天后到期`;
            } else {
                return date.toLocaleDateString('zh-CN');
            }
        }

        // ========================================
        // 🔧 工具函数
        // ========================================
        
        // 显示通知
        function showNotification(message, type = 'success') {
            // TODO: 实现通知功能
            console.log(message);
        }

        // 显示任务菜单
        function showTaskMenu(event, taskId) {
            event.stopPropagation();
            // TODO: 实现右键菜单功能
            console.log('显示任务菜单:', taskId);
        }

        // 加载任务详情
        function loadTaskDetail(taskId) {
            // TODO: 从数据源加载任务详情
            console.log('加载任务详情:', taskId);
        }

        // ========================================
        // 🔌 与 MNTask 插件通信
        // ========================================
        
        // 发送消息到插件
        function sendToPlugin(action, data = {}) {
            const message = {
                source: 'taskDashboard',
                action: action,
                data: data,
                timestamp: Date.now()
            };
            
            // 构建协议URL
            const url = `mntask://dashboard?message=${encodeURIComponent(JSON.stringify(message))}`;
            console.log('📤 发送到插件:', message);
            
            // 触发URL协议
            window.location.href = url;
        }

        // 接收插件消息
        window.receiveFromPlugin = function(action, jsonData) {
            console.log('📥 收到插件消息:', action, jsonData);
            
            try {
                const data = JSON.parse(jsonData);
                
                switch(action) {
                    case 'loadTasks':
                        // 加载任务数据
                        loadTasksFromPlugin(data);
                        break;
                        
                    case 'taskUpdated':
                        // 任务更新通知
                        showNotification(data.message || '任务已更新');
                        break;
                        
                    case 'syncData':
                        // 同步数据
                        syncWithPlugin(data);
                        break;
                        
                    default:
                        console.log('未知的操作:', action);
                }
            } catch (error) {
                console.error('❌ 处理插件数据失败:', error);
            }
        };

        // 从插件加载任务
        function loadTasksFromPlugin(data) {
            // TODO: 实现从插件加载任务的逻辑
            console.log('从插件加载任务:', data);
        }

        // 与插件同步数据
        function syncWithPlugin(data) {
            // TODO: 实现数据同步逻辑
            console.log('与插件同步数据:', data);
        }

        // ========================================
        // 🎬 初始化
        // ========================================
        
        // 页面加载完成后初始化
        window.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 任务管理看板启动');
            
            // 初始化示例数据
            initializeSampleData();
            
            // 更新列计数
            updateColumnCounts();
            
            // 请求插件数据
            setTimeout(() => {
                sendToPlugin('requestTasks');
            }, 100);
            
            // 绑定全局事件
            bindGlobalEvents();
        });

        // 绑定全局事件
        function bindGlobalEvents() {
            // ESC 键关闭模态框
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    const modal = document.querySelector('.modal.active');
                    if (modal) {
                        if (modal.id === 'createTaskModal') {
                            hideCreateTaskModal();
                        }
                    }
                }
            });
            
            // 点击模态框背景关闭
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        if (modal.id === 'createTaskModal') {
                            hideCreateTaskModal();
                        }
                    }
                });
            });
            
            // 搜索功能
            document.querySelector('.search-input')?.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                filterTasks(searchTerm);
            });
        }

        // 任务筛选
        function filterTasks(searchTerm) {
            const allCards = document.querySelectorAll('.task-card');
            
            allCards.forEach(card => {
                const title = card.querySelector('.task-title').textContent.toLowerCase();
                const description = card.querySelector('.task-description').textContent.toLowerCase();
                const tags = Array.from(card.querySelectorAll('.task-tag')).map(tag => tag.textContent.toLowerCase()).join(' ');
                
                const searchContent = `${title} ${description} ${tags}`;
                
                if (searchContent.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // ========================================
        // 📱 响应式处理
        // ========================================
        
        // 检测移动设备
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // 处理响应式布局
        function handleResponsive() {
            if (isMobile()) {
                // 移动端适配
                document.querySelector('.sidebar')?.classList.add('hidden');
                document.querySelector('.detail-panel')?.classList.add('hidden');
            }
        }

        // 监听窗口大小变化
        window.addEventListener('resize', handleResponsive);

        // ========================================
        // 🎨 主题切换（预留功能）
        // ========================================
        
        // 切换主题
        function toggleTheme() {
            const root = document.documentElement;
            const currentTheme = root.getAttribute('data-theme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            root.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        // 加载保存的主题
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // 初始化主题
        loadTheme();

        /* ========================================
           📚 开发说明和学习要点
           
           这个任务管理看板展示了现代化的Web应用开发技术：
           
           1. 🎨 视觉设计
              - 使用CSS变量实现主题系统
              - 玻璃拟态(Glassmorphism)效果
              - 渐变色和动画效果
              - 响应式设计
           
           2. 🏗️ 架构设计
              - 模块化的代码组织
              - 事件驱动的交互设计
              - 数据与视图分离
              - 插件通信机制
           
           3. 🎯 核心功能
              - 拖拽API实现看板功能
              - 模态框和表单处理
              - 实时搜索和筛选
              - 数据持久化
           
           4. 🔧 技术要点
              - CSS Grid和Flexbox布局
              - CSS动画和过渡效果
              - 原生JavaScript事件处理
              - LocalStorage数据存储
           
           5. 🚀 扩展方向
              - 添加更多视图（日历、甘特图）
              - 实现协作功能
              - 集成第三方服务
              - 添加数据统计和报表
           
           这个示例为MNTask插件提供了一个功能完整、
           视觉美观的任务管理界面，可以根据实际需求
           进行定制和扩展。
           ======================================== */
    </script>
</body>
</html>