<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MNTask Hello World ç¤ºä¾‹</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f7;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #1d1d1f;
            margin-bottom: 20px;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .button {
            display: inline-block;
            padding: 12px 24px;
            margin: 10px 10px 10px 0;
            background-color: #007aff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .button:hover {
            background-color: #0063d1;
        }
        
        .button:active {
            transform: scale(0.98);
        }
        
        /* æ¶ˆæ¯æ˜¾ç¤ºåŒº */
        .message-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 8px;
            min-height: 50px;
        }
        
        .message-box h3 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 14px;
        }
        
        #messages {
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status.ready {
            background-color: #d1f2d1;
            color: #2e7d2e;
        }
        
        .status.loading {
            background-color: #fff3cd;
            color: #856404;
        }
        
        /* ä»£ç å±•ç¤ºåŒº */
        .code-preview {
            margin-top: 20px;
            padding: 15px;
            background-color: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
        
        .code-comment {
            color: #6a9955;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ MNTask Hello World</h1>
        
        <p>è¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ WebView ä¸æ’ä»¶é€šä¿¡ç¤ºä¾‹ã€‚ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æ¥æµ‹è¯•é€šä¿¡åŠŸèƒ½ã€‚</p>
        
        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <p>
            é¡µé¢çŠ¶æ€ï¼š<span id="status" class="status loading">åˆå§‹åŒ–ä¸­...</span>
        </p>
        
        <!-- æ“ä½œæŒ‰é’® -->
        <div style="margin: 20px 0;">
            <button class="button" onclick="sayHello()">
                ğŸ‘‹ å‘æ’ä»¶è¯´ Hello
            </button>
            
            <button class="button" onclick="getCurrentTime()">
                â° è·å–å½“å‰æ—¶é—´
            </button>
            
            <button class="button" onclick="sendData()">
                ğŸ“¤ å‘é€æµ‹è¯•æ•°æ®
            </button>
        </div>
        
        <!-- æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ -->
        <div class="message-box">
            <h3>ğŸ“¨ æ¶ˆæ¯è®°å½•ï¼š</h3>
            <div id="messages">ç­‰å¾…äº¤äº’...</div>
        </div>
        
        <!-- ä»£ç é¢„è§ˆï¼ˆæ•™å­¦ç”¨ï¼‰ -->
        <div class="code-preview">
            <span class="code-comment">// å½“å‰æ‰§è¡Œçš„ä»£ç ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</span>
            <div id="codePreview"></div>
        </div>
    </div>
    
    <script>
        // ==================== å·¥å…·å‡½æ•° ====================
        
        /**
         * æ·»åŠ æ¶ˆæ¯åˆ°æ˜¾ç¤ºåŒº
         * @param {string} message - è¦æ˜¾ç¤ºçš„æ¶ˆæ¯
         * @param {string} type - æ¶ˆæ¯ç±»å‹ (send/receive/info)
         */
        function addMessage(message, type = 'info') {
            const messagesDiv = document.getElementById('messages');
            const timestamp = new Date().toLocaleTimeString();
            
            // åˆ›å»ºæ¶ˆæ¯å…ƒç´ 
            const messageElement = document.createElement('div');
            messageElement.style.marginBottom = '5px';
            
            // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒçš„æ ·å¼
            let prefix = '';
            let color = '#333';
            
            switch(type) {
                case 'send':
                    prefix = 'ğŸ“¤ å‘é€ï¼š';
                    color = '#007aff';
                    break;
                case 'receive':
                    prefix = 'ğŸ“¥ æ¥æ”¶ï¼š';
                    color = '#34c759';
                    break;
                case 'error':
                    prefix = 'âŒ é”™è¯¯ï¼š';
                    color = '#ff3b30';
                    break;
                default:
                    prefix = 'â„¹ï¸ ä¿¡æ¯ï¼š';
                    color = '#666';
            }
            
            messageElement.innerHTML = `
                <span style="color: #999; font-size: 12px;">[${timestamp}]</span>
                <span style="color: ${color};">${prefix}</span>
                ${message}
            `;
            
            // æ·»åŠ åˆ°æ¶ˆæ¯åŒºåŸŸï¼ˆæœ€æ–°çš„åœ¨ä¸Šé¢ï¼‰
            messagesDiv.insertBefore(messageElement, messagesDiv.firstChild);
            
            // é™åˆ¶æ¶ˆæ¯æ•°é‡
            while (messagesDiv.children.length > 10) {
                messagesDiv.removeChild(messagesDiv.lastChild);
            }
        }
        
        /**
         * æ˜¾ç¤ºæ‰§è¡Œçš„ä»£ç 
         * @param {string} code - ä»£ç å†…å®¹
         */
        function showCode(code) {
            const codePreview = document.getElementById('codePreview');
            codePreview.textContent = code;
        }
        
        // ==================== ä¸æ’ä»¶é€šä¿¡çš„å‡½æ•° ====================
        
        /**
         * å‘æ’ä»¶å‘é€ Hello æ¶ˆæ¯
         * æ¼”ç¤ºæœ€åŸºæœ¬çš„ URL Scheme é€šä¿¡
         */
        function sayHello() {
            // æ˜¾ç¤ºä»£ç 
            showCode("window.location.href = 'mntask://sayHello?message=Hello%20from%20WebView!'");
            
            // è®°å½•å‘é€çš„æ¶ˆæ¯
            addMessage("Hello from WebView!", 'send');
            
            // ä½¿ç”¨ URL Scheme å‘é€æ¶ˆæ¯åˆ°æ’ä»¶
            // æ³¨æ„ï¼šä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦éœ€è¦ä½¿ç”¨ encodeURIComponent ç¼–ç 
            window.location.href = 'mntask://sayHello?message=' + encodeURIComponent('Hello from WebView!');
        }
        
        /**
         * è¯·æ±‚æ’ä»¶è·å–å½“å‰æ—¶é—´
         * æ¼”ç¤ºè¯·æ±‚-å“åº”æ¨¡å¼
         */
        function getCurrentTime() {
            // æ˜¾ç¤ºä»£ç 
            showCode("window.location.href = 'mntask://getTime'");
            
            addMessage("è¯·æ±‚å½“å‰æ—¶é—´", 'send');
            
            // å‘é€è¯·æ±‚
            window.location.href = 'mntask://getTime';
        }
        
        /**
         * å‘é€å¤æ‚æ•°æ®åˆ°æ’ä»¶
         * æ¼”ç¤ºå¦‚ä½•ä¼ é€’ JSON æ•°æ®
         */
        function sendData() {
            // å‡†å¤‡æµ‹è¯•æ•°æ®
            const testData = {
                name: "æµ‹è¯•ä»»åŠ¡",
                type: "ä»»åŠ¡",
                status: "è¿›è¡Œä¸­",
                tags: ["é‡è¦", "ç´§æ€¥"],
                createdAt: new Date().toISOString()
            };
            
            // æ˜¾ç¤ºä»£ç 
            const code = `const data = ${JSON.stringify(testData, null, 2)};
const encoded = encodeURIComponent(JSON.stringify(data));
window.location.href = 'mntask://receiveData?data=' + encoded;`;
            showCode(code);
            
            addMessage("å‘é€æµ‹è¯•æ•°æ®: " + JSON.stringify(testData), 'send');
            
            // ç¼–ç å¹¶å‘é€æ•°æ®
            const encoded = encodeURIComponent(JSON.stringify(testData));
            window.location.href = 'mntask://receiveData?data=' + encoded;
        }
        
        // ==================== æ¥æ”¶æ’ä»¶çš„æ¶ˆæ¯ ====================
        
        /**
         * æ¥æ”¶æ’ä»¶å‘æ¥çš„æ¶ˆæ¯
         * è¿™ä¸ªå‡½æ•°ä¼šè¢«æ’ä»¶é€šè¿‡ evaluateJavaScript è°ƒç”¨
         * @param {string} message - æ¶ˆæ¯å†…å®¹
         */
        function receiveMessage(message) {
            addMessage(message, 'receive');
            
            // æ˜¾ç¤ºæ’ä»¶è°ƒç”¨çš„ä»£ç 
            showCode(`// æ’ä»¶æ‰§è¡Œçš„ä»£ç ï¼š
webView.evaluateJavaScript('receiveMessage("${message}")')`)
        }
        
        /**
         * æ¥æ”¶æ’ä»¶å‘æ¥çš„æ—¶é—´æ•°æ®
         * @param {string} timeString - æ—¶é—´å­—ç¬¦ä¸²
         */
        function receiveTime(timeString) {
            addMessage("å½“å‰æ—¶é—´: " + timeString, 'receive');
            
            // æ˜¾ç¤ºä¸€ä¸ªæç¤º
            const alertDiv = document.createElement('div');
            alertDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background-color: #34c759;
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                animation: slideIn 0.3s ease-out;
            `;
            alertDiv.textContent = 'â° ' + timeString;
            document.body.appendChild(alertDiv);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                alertDiv.remove();
            }, 3000);
        }
        
        /**
         * æ¥æ”¶æ’ä»¶ç¡®è®¤æ”¶åˆ°æ•°æ®
         * @param {boolean} success - æ˜¯å¦æˆåŠŸ
         * @param {string} message - é™„åŠ æ¶ˆæ¯
         */
        function receiveDataConfirm(success, message) {
            if (success) {
                addMessage("âœ… æ’ä»¶å·²æ”¶åˆ°æ•°æ®: " + message, 'receive');
            } else {
                addMessage("âŒ æ•°æ®å‘é€å¤±è´¥: " + message, 'error');
            }
        }
        
        // ==================== é¡µé¢åˆå§‹åŒ– ====================
        
        /**
         * é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
         */
        window.onload = function() {
            console.log('[Hello World] é¡µé¢åŠ è½½å®Œæˆ');
            
            // æ›´æ–°çŠ¶æ€
            document.getElementById('status').className = 'status ready';
            document.getElementById('status').textContent = 'å·²å°±ç»ª';
            
            addMessage("é¡µé¢å·²åŠ è½½å®Œæˆ", 'info');
            
            // é€šçŸ¥æ’ä»¶é¡µé¢å·²å‡†å¤‡å°±ç»ª
            // è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œè®©æ’ä»¶çŸ¥é“å¯ä»¥å¼€å§‹å‘é€æ•°æ®äº†
            window.location.href = 'mntask://pageReady';
            
            // æ·»åŠ  CSS åŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
        };
        
        // ==================== è°ƒè¯•è¾…åŠ© ====================
        
        // åœ¨æ§åˆ¶å°æ˜¾ç¤ºæ‰€æœ‰çš„æ¶ˆæ¯
        console.log('%cğŸ¯ MNTask Hello World ç¤ºä¾‹å·²åŠ è½½', 
                    'color: #007aff; font-size: 16px; font-weight: bold;');
        console.log('å¯ç”¨çš„å‡½æ•°ï¼š');
        console.log('- sayHello(): å‘æ’ä»¶å‘é€ Hello');
        console.log('- getCurrentTime(): è·å–å½“å‰æ—¶é—´');
        console.log('- sendData(): å‘é€æµ‹è¯•æ•°æ®');
        console.log('- receiveMessage(msg): æ¥æ”¶æ’ä»¶æ¶ˆæ¯');
    </script>
</body>
</html>