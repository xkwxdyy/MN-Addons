<!DOCTYPE HTML>
<html lang="en">
<head>
    <!-- when using the mode "code", it's important to specify charset utf-8 -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <title>Vditor</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link href="jsoneditor.min.css" rel="stylesheet" type="text/css">
    <script src="jsoneditor.min.js"></script>
</head>
<style>
body {
    margin: 0;
    padding: 0;
    height: 100vh !important;
    min-height: 100vh !important;
    overflow-y: hidden;
}


</style>
<body>
  <div id="jsoneditor"></div>
  <script>
    // create the editor
    const container = document.getElementById("jsoneditor")
    const actionProperties = {
      "action": {
        "title": "Action",
        "type": "string",
        "enum": ['addChildNote','addBrotherNote','addComment','addImageComment','crash','clearContent','cloneAndMerge','cloneAsChildNote','confirm','chatAI','copy','command','export','focus','link','moveNote','mergeText','moveComment','menu','noteHighlight','openURL','ocr','paste','replace','removeComment','showInFloatWindow','switchTitleOrExcerpt','search','setContent','showMessage','setButtonImage','shortcut','triggerButton','toggleView','toggleTextFirst','toggleMarkdown'],
      },
      "ocr":{
        type:"boolean",
        default:false
      },
      "commandDelay":{
        "title": "delay",
        "type": "number",
        "enum": [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0],
      },
      "delay":{
        "title": "delay",
        "type": "number",
        "enum": [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0],
      },
      "tag": {
        "title": "tag",
        "type": "string"
      },
      "tags": {
        "title": "tags",
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "targets": {
        "title": "Targets",
        "type": "array",
        "items": {
          "type": "string",
          "enum": ['addonBar','mindmapToolbar'],
        }
      },
      "menuWidth": {
        "title": "menuWidth",
        "type": "integer",
        "enum": [100,150,200,250,300],
      },
      "menuTitle": {
        "title": "menuTitle",
        "type": "string",
      },
      "linkType": {
        "title": "linkType",
        "type": "string",
        "enum": ['Both','To','From'],
      },
      "range": {
        "title": "range",
        "type": "string",
        "enum": ['currentNotes','childNotes','descendants'],
      },
      "target": {
        "title": "target",
        "type": "string",
        "enum": ['addonBar','appendTitle','appendExcerpt','auto','both','comment','comments','clipboard','currentNote','currentChildMap','currentPrompt','currentNoteInMindMap','clipboardText','chatModeReference','doc','default','editor','excerpt','excerptText','excerptOCR','floatMindmap','menu','mindmap','mainMindMap','mindmapToolbar','newComment','notesText','noteId','noteURL','noteMarkdown','noteMarkdownOCR','noteWithDecendentsMarkdown','noteInClipboard','openFloat','parentNote','selectionText','selectionImage','title'],
      },
      "fillPattern": {
        "title": "fillPattern",
        "type": "integer",
        "enum": [-1,0,1,2],
      },
      "type": {
        "title": "type",
        "type": "string",
        "enum":['TextNote','HtmlNote','PaintNote','LinkNote','tagComment','linkComment','markdownComment','textComment','HtmlComment','blankTextComment','blankImageComment','mergedImageCommentWithDrawing','mergedImageComment','mergedTextComment','imageCommentWithDrawing','imageComment','drawingComment'],
      },
      "types": {
        "title": "types",
        "type": "array",
        "items": {
          "type": "string",
          "enum":['TextNote','HtmlNote','PaintNote','LinkNote','tagComment','linkComment','markdownComment','textComment','HtmlComment','blankTextComment','blankImageComment','mergedImageCommentWithDrawing','mergedImageComment','mergedTextComment','imageCommentWithDrawing','imageComment','drawingComment']
        }
      },
      "find":{
        "title": "find",
        "type": "object",
        "properties": {
          "include": {
            "title": "include",
            "type": "string",
          },
          "exclude": {
            "title": "exclude",
            "type": "string",
          },
          "reg": {
            "title": "reg",
            "type": "string",
          },
          "type": {
            "title": "type",
            "type": "string",
            "enum":['TextNote','HtmlNote','PaintNote','LinkNote','tagComment','linkComment','markdownComment','textComment','HtmlComment','blankTextComment','blankImageComment','mergedImageCommentWithDrawing','mergedImageComment','mergedTextComment','imageCommentWithDrawing','imageComment','drawingComment']
          },
          "types": {
            "title": "types",
            "type": "array",
            "items": {
              "type": "string",
              "enum":['TextNote','HtmlNote','PaintNote','LinkNote','tagComment','linkComment','markdownComment','textComment','HtmlComment','blankTextComment','blankImageComment','mergedImageCommentWithDrawing','mergedImageComment','mergedTextComment','imageCommentWithDrawing','imageComment','drawingComment']
            }
          },
        }
      },
      "command": {
        "title": "command",
        "type": "string",
        "enum": ['GoNewFeatures','GoUserGuide','GoManual','InAppPurchase','DBVaults','ShareLicenses','SharePackage','GoiCloud','ExportPKG','ExportVault','ExportMapPDF','ExportDocPDF','ExportOmni','ExportWord','ExportMind','ExportAnki','BackupDB','ClearTemp','OpenTrash','OpenExtensions','GoSettings','EditUndo','EditRedo','EditCut','CommonCopy','EditPaste','EditSelAll','EditMarkdown','ToggleDocument','ToggleMindMap','ToggleCards','ToggleReview','ToggleResearch','ToggleMoreSettings','ToggleSidebar','FullTextSearch','DraftList','ManageDocs','ToggleFullDoc','ToggleBookLeft','ToggleBookBottom','ToggleTabsBar','ToggleAddFile','TabNextFile','TabPrevFile','ToggleSplit','BindSplit','EmphasisCloze','ToggleTextLink','SyncMindMapToBook','SyncBookToMindMap','SyncWindowPos','SyncDeletion','SetRefCopyMode','SetCloneCopyMode','UIStatusURL','BookTOC','BookPageList','BookMarkList','BookSketchList','BookCardList','EditDocLayers','ViewDocCardGroup','BookSearch','BookPageFlip','BookPageScroll','ExtendSplit','ExtendMargin','ExtendPopup','PdfCrop','BookPageNumber','GoBack','GoForward','BookMarkAdd','BookMarkRemove','EditPDFPages','AddToTOC','SplitBook','InsertBlank','Translate','FoldHighlight','SourceHighlight','EditTextBox','EditImageBox','ExcerptToolSettings','ExcerptToolSelect','ExcerptToolCustom0','ExcerptToolCustom1','ExcerptToolCustom2','ExcerptToolCustom3','HighlightShortcut1','HighlightShortcut2','HighlightShortcut3','HighlightShortcut4','ExcerptToolSketch','NotebookOutline','ViewMapCardGroup','EditMultiSel','FocusNote','FocusParent','NotebookOutlineEdit','EditOutlineIncLevel','EditOutlineDecLevel','SnippetMode','NewSiblingNote','NewChildNote','NewParentNote','ToggleExpand','EditGroupNotes','EditLinkNotes','EditMergeNotes','SelBranchStyle0','SelBranchStyle3','SelBranchStyle2','SelBranchStyle1','SelBranchStyle4','SelBranchStyle60','SelBranchStyle61','SelBranchStyle64','SelBranchStyle7','SelBranchStyle100','GlobalBranchStyle','ZoomToFit','ViewExpandAll','ViewCollapseAll','ViewExpandLevel0','ViewExpandLevel1','ViewExpandLevel2','ViewExpandLevel3','ViewExpandLevel4','ViewExpandLevel5','ViewExpandLevel6','ViewExpandLevel7','ViewExpandRows','ViewCollapseRows','EditArrangeNotes','MindmapSnippetMode','SelectBranch','ShowSketch','HideSketch','EditCopy','EditReference','EditCopyLink','EditDeleteNote','EditColorNoteIndex0','EditColorNoteIndex1','EditColorNoteIndex2','EditColorNoteIndex3','EditColorNoteIndex4','EditColorNoteIndex5','EditColorNoteIndex6','EditColorNoteIndex7','EditColorNoteIndex8','EditColorNoteIndex9','EditColorNoteIndex10','EditColorNoteIndex11','EditColorNoteIndex12','EditColorNoteIndex13','EditColorNoteIndex14','EditColorNoteIndex15','EditTagNote','EditAddTitle','EditAddText','EditAppendComment','ContinueExcerpt','EditTextMode','EditOcclusion','EditUnmergeNote','TextToTitle','ExpandExtend','CollapseExtend','SendToMap','RemoveFromMap','AddToReview','ClearFormat1','ClearFormat2','FlashcardSpeech','SetTitleHighlight','SetCommentHighlight','SetAsEmphasis','MergeTo','FlashcardsPlay','FlashcardsStop','FlashcardFlip','FlashcardLocal','FlashcardAgain','FlashcardHard','FlashcardGood','FlashcardEasy','FlashcardStarred'],
      },
      "color": {
        "title": "linkType",
        "enum": [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,'parent','current'],
      },
      "trim": {
        "type": "boolean",
        "default": false
      },
      "markdown": {
        "type": "boolean",
        "default": false
      },
      "autoClose": {
        "type": "boolean",
        "default": false
      },
      "asTitle": {
        "type": "boolean",
        "default": false
      },
      "mainMindMap": {
        "type": "boolean",
        "default": false
      },
      "compression": {
        "type": "boolean",
        "default": true
      },
      "onFinish": {
        "$ref": "action"
      },
      "onLongPress": {
        "$ref": "action"
      },
      "onSuccess": {
        "$ref": "action"
      },
      "doubleClick": {
        "$ref": "action"
      },
      "onFailed": {
        "$ref": "action"
      },
      "onConfirm": {
        "$ref": "action"
      },
      "onCancel": {
        "$ref": "action"
      },
      "menuItems": {   
        "type": "array",
        "items": {
          "oneOf":[
          {
            "$ref": "menuAction"
          },
          {
            "$ref": "menuTitle"
          }
          ]
        }
      },
      "name":{
        type:"string",
      },
      "steps": {
        "type": "array",
      },
      "commands": {
        "type": "array",
        "items": {
          "enum": ['GoNewFeatures','GoUserGuide','GoManual','InAppPurchase','DBVaults','ShareLicenses','SharePackage','GoiCloud','ExportPKG','ExportVault','ExportMapPDF','ExportDocPDF','ExportOmni','ExportWord','ExportMind','ExportAnki','BackupDB','ClearTemp','OpenTrash','OpenExtensions','GoSettings','EditUndo','EditRedo','EditCut','CommonCopy','EditPaste','EditSelAll','EditMarkdown','ToggleDocument','ToggleMindMap','ToggleCards','ToggleReview','ToggleResearch','ToggleMoreSettings','ToggleSidebar','FullTextSearch','DraftList','ManageDocs','ToggleFullDoc','ToggleBookLeft','ToggleBookBottom','ToggleTabsBar','ToggleAddFile','TabNextFile','TabPrevFile','ToggleSplit','BindSplit','EmphasisCloze','ToggleTextLink','SyncMindMapToBook','SyncBookToMindMap','SyncWindowPos','SyncDeletion','SetRefCopyMode','SetCloneCopyMode','UIStatusURL','BookTOC','BookPageList','BookMarkList','BookSketchList','BookCardList','EditDocLayers','ViewDocCardGroup','BookSearch','BookPageFlip','BookPageScroll','ExtendSplit','ExtendMargin','ExtendPopup','PdfCrop','BookPageNumber','GoBack','GoForward','BookMarkAdd','BookMarkRemove','EditPDFPages','AddToTOC','SplitBook','InsertBlank','Translate','FoldHighlight','SourceHighlight','EditTextBox','EditImageBox','ExcerptToolSettings','ExcerptToolSelect','ExcerptToolCustom0','ExcerptToolCustom1','ExcerptToolCustom2','ExcerptToolCustom3','HighlightShortcut1','HighlightShortcut2','HighlightShortcut3','HighlightShortcut4','ExcerptToolSketch','NotebookOutline','ViewMapCardGroup','EditMultiSel','FocusNote','FocusParent','NotebookOutlineEdit','EditOutlineIncLevel','EditOutlineDecLevel','SnippetMode','NewSiblingNote','NewChildNote','NewParentNote','ToggleExpand','EditGroupNotes','EditLinkNotes','EditMergeNotes','SelBranchStyle0','SelBranchStyle3','SelBranchStyle2','SelBranchStyle1','SelBranchStyle4','SelBranchStyle60','SelBranchStyle61','SelBranchStyle64','SelBranchStyle7','SelBranchStyle100','GlobalBranchStyle','ZoomToFit','ViewExpandAll','ViewCollapseAll','ViewExpandLevel0','ViewExpandLevel1','ViewExpandLevel2','ViewExpandLevel3','ViewExpandLevel4','ViewExpandLevel5','ViewExpandLevel6','ViewExpandLevel7','ViewExpandRows','ViewCollapseRows','EditArrangeNotes','MindmapSnippetMode','SelectBranch','ShowSketch','HideSketch','EditCopy','EditReference','EditCopyLink','EditDeleteNote','EditColorNoteIndex0','EditColorNoteIndex1','EditColorNoteIndex2','EditColorNoteIndex3','EditColorNoteIndex4','EditColorNoteIndex5','EditColorNoteIndex6','EditColorNoteIndex7','EditColorNoteIndex8','EditColorNoteIndex9','EditColorNoteIndex10','EditColorNoteIndex11','EditColorNoteIndex12','EditColorNoteIndex13','EditColorNoteIndex14','EditColorNoteIndex15','EditTagNote','EditAddTitle','EditAddText','EditAppendComment','ContinueExcerpt','EditTextMode','EditOcclusion','EditUnmergeNote','TextToTitle','ExpandExtend','CollapseExtend','SendToMap','RemoveFromMap','AddToReview','ClearFormat1','ClearFormat2','FlashcardSpeech','SetTitleHighlight','SetCommentHighlight','SetAsEmphasis','MergeTo','FlashcardsPlay','FlashcardsStop','FlashcardFlip','FlashcardLocal','FlashcardAgain','FlashcardHard','FlashcardGood','FlashcardEasy','FlashcardStarred'],
        }
      },
      "content": {
        "type":"string"
      }
    }
    const action = {
    "title": "Action",
    "description": "Object containing employee details",
    "type": "object",
    "properties": actionProperties,
    "required": ["action"]
  }
  const menuTitle = {
    "type": "string",
    "title": "Menu Title",
    "description": "Title of the menu item",
  }
  const menuAction = {
    "title": "Action",
    "description": "Object containing employee details",
    "type": "object",
    "properties": actionProperties
  }
    function adjustSelectWidth() {
        const selects = document.getElementsByTagName('select');
        for (let index = 0; index < selects.length; index++) {
          const select = selects[index];
          const maxWidth = window.innerWidth - select.getBoundingClientRect().left-30;
          select.style.maxWidth = `${maxWidth}px`;
        }
    }
 function moveDuplicateAndRemoveToFront(arr) {

    // // // Find the index of the element with className 'jsoneditor-duplicate'
    // const DuplicateIndex = arr.findIndex(item => item.className === 'jsoneditor-duplicate');

    // // If such an element exists and is not already the first element
    // if (DuplicateIndex > -1) {
    //     // Extract the element
    //     const [duplicateItem] = arr.splice(DuplicateIndex, 1);
    //     // Move the element to the front
    //     arr.push(duplicateItem);
    // }

    const removeIndex = arr.findIndex(item => item.className === 'jsoneditor-remove');

    if (removeIndex > -1) {
        // Extract the element
        const [removeItem] = arr.splice(removeIndex, 1);
        // Move the element to the front
        arr.unshift(removeItem);
    }

    const extractIndex = arr.findIndex(item => item.className === "jsoneditor-extract");
    if (extractIndex > -1) {
        const [extractItem] = arr.splice(extractIndex, 1);
        // Move the element to the front
        arr.push(extractItem);
    }

    return arr;
}
function copyToClipboard(text) {
  window.location.href = "nativeCopy://content="+encodeURIComponent(text);
}
    const options = {
      schema: action,
      schemaRefs: {action:action,menuTitle:menuTitle,menuAction:menuAction},
      theme: 'ace',
      allowSchemaSuggestions: true,
      onCreateMenu:(items, node)=> {
        
        let path = node.path
        if (path.length) {
          items.unshift({
              text: '拷贝值',
              title: 'copy',
              className: 'jsoneditor-duplicate',
              click:()=>{
                let tem = editor.get()
                for (let index = 0; index <= path.length - 1; index++) {
                  tem = tem[path[index]]
                }
                copyToClipboard(JSON.stringify(tem,null,2))
              }
          })
        }else{
          items.unshift({
              text: '拷贝',
              title: 'copy',
              className: 'jsoneditor-duplicate',
              click:()=>{
                let tem = editor.get()
                copyToClipboard(JSON.stringify(tem,null,2))

              }
          })
        }
        moveDuplicateAndRemoveToFront(items)
        return items
      },
      onEvent:(node, event)=> {
        if (event.type === 'blur') {
          editor.refresh()
          removeFocus()
          return
        }
        if (event.type === 'change') {
          // console.log("change");
          // editor.refresh()
          let config = editor.get()
          let needSet = false
          switch (config.action) {
            case "copy":
              if (!("target" in config)) {
                config.target = "auto"
                needSet = true
              } 
              break;
            case "addComment":
              if (!("content" in config)) {
                config.content = ""
                needSet = true
              } 
              break;
            case "menu":
              if (!("menuItems" in config)) {
                config.menuItems = []
                needSet = true
              } 
              break;
            case "mergeText":
              if (!("source" in config)) {
                config.source = []
                needSet = true
              } 
              if (!("target" in config)) {
                config.target = "excerptText"
                needSet = true
              } 
              break;
            case "ocr":
              if(!("target" in config)){
                config.target = "excerpt"
                needSet = true
              }
              break;
            case "shortcut":{
              if (!("name" in config)) {
                config.name = ""
                needSet = true
              }
            }
            case "replace":
              if(!("target" in config)){
                config.target = "excerpt"
                needSet = true
              }
              break;
            case "openURL":
              if(!("url" in config)){
                config.url = ""
                needSet = true
              }
              break;
            case "triggerButton":
              if(!("buttonName" in config)){
                config.buttonName = ""
                needSet = true
              }
              break;
            case "confirm":
              if(!("title" in config)){
                config.title = ""
                needSet = true
              }
              if(!("onConfirm" in config)){
                config.onConfirm = {
                  "action": "",
                }
                needSet = true
              }
              break;
            case "showMessage":
              if(!("content" in config)){
                config.content = ""
                needSet = true
              }
            default:
              break;
          }
          if (needSet) {
            editor.set(config)
          }
          removeFocus()
          return
        }
        if (event.type === 'keyup' && event.key === 'Tab') {
          editor.refresh()
          adjustSelectWidth()
          return
        }
        
      },
      "enableSort": false,
      "enableTransform": false,
      "search": false,
      "mode":"tree",
      "templates": [
        {
            text: '结束动作',
            title: 'onFinish action',
            className: 'jsoneditor-type-object',
            field: 'onFinish',
            value: {
                'action': ''
            }
        },
        {
            text: '长按动作',
            title: 'onLongPress action',
            className: 'jsoneditor-type-object',
            field: 'onLongPress',
            value: {
                'action': ''
            }
        },
        {
            text: '结束确认',
            title: 'confirm action',
            className: 'jsoneditor-type-object',
            field: 'onFinish',
            value: {
              "action": "confirm",
              "title": "请点击确认",
              "onConfirm": {
                "action": "",
              },
              "onCancel": {
                "action": "",
              }
            }
        },
        {
            text: '双击动作',
            title: 'doubleClick action',
            className: 'jsoneditor-type-object',
            field: 'doubleClick',
            value: {
                'action': ''
            }
        },
        {
            text: '菜单选项',
            title: 'menu items',
            className: 'jsoneditor-type-array',
            field: 'menuItems',
            value: []
        },
        {
            text: '步骤选项',
            title: 'steps',
            className: 'jsoneditor-type-array',
            field: 'steps',
            value: []
        },
      ],
      limitDragging:false,
      "navigationBar":false,
      "colorPicker":false,
      "autocomplete": {
        filter:"contain",
        getOptions: function (text, path, input, editor) {
          //input: filed, value
          //path: array
          // console.log(input);
          if (input === 'field') {
            return ['find','delay','noteURL','menuWidth','buttonName','subTitle','onConfirm','onCancel','followAutoStyle','menuTitle','name','input','text','target', 'action', 'description','menu', 'source','color','content','title','markdown','command','commands','OCR','fillPattern','asTitle','tags','tag','find','multi','type','index','removeSource','prompt','user','system','trim','replace','merge','linkType','from','to','steps','range','url','engine','targets','onFinish','onLongPress','doubleClick','menuItems','autoClose','parentNote','mainMindMap','method','paste'];
          }
          if (input === 'value') {
            let parent = path.at(-1)
            if (typeof parent === 'number') {
              parent = path.at(-2)
            }
            switch (parent) {
              case 'method':
                return ['replace','append']
              case 'content':
                return ['{{note.title}}','{{{note.url}}}','{{{date.now}}}']
              case 'targets':
                return ['addonBar','mindmapToolbar']
              case 'source':
                return ['photo','camera','file','parentNote','noteDoc','note','currentDoc','default','doc2x','simpletex', 'GPT-4o','GPT-4o-mini'];
              case 'action':
                return ['showMessage','confirm','triggerButton','switchTitleOrExcerpt','ocr','moveNote','chatAI','command','setButtonImage','addImageComment','mergeText','toggleView','menu','shortcut','replace','showInFloatWindow','openURL','copy','addComment','export','removeComment','moveComment','paste','setContent','clearContent','search','noteHighlight','cloneAndMerge','cloneAsChildNote','addChildNote','addBrotherNote','crash','link','toggleTextFirst','toggleMarkdown','focus'];
              case 'trim':
              case 'markdown':
              case 'autoClose':
              case 'asTitle':
              case 'mainMindMap':
                return [true,false];
              case 'steps':
                return ['from','to','reg','mod'];
              case 'linkType':
                return ['Both','To','From'];
              case 'range':
                return ['currentNotes','childNotes','descendants'];
              case 'target':
                return ['addonBar','appendTitle','appendExcerpt','auto','both','comment','comments','clipboard','currentNote','currentChildMap','currentPrompt','currentNoteInMindMap','clipboardText','chatModeReference','doc','default','editor','excerpt','excerptText','excerptOCR','floatMindmap','menu','mindmap','mainMindMap','mindmapToolbar','newComment','notesText','noteId','noteURL','noteMarkdown','noteMarkdownOCR','noteWithDecendentsMarkdown','noteInClipboard','openFloat','parentNote','selectionText','selectionImage','title'];
              case 'command':
              case 'commands':
                return ['GoNewFeatures','GoUserGuide','GoManual','InAppPurchase','DBVaults','ShareLicenses','SharePackage','GoiCloud','ExportPKG','ExportVault','ExportMapPDF','ExportDocPDF','ExportOmni','ExportWord','ExportMind','ExportAnki','BackupDB','ClearTemp','OpenTrash','OpenExtensions','GoSettings','EditUndo','EditRedo','EditCut','CommonCopy','EditPaste','EditSelAll','EditMarkdown','ToggleDocument','ToggleMindMap','ToggleCards','ToggleReview','ToggleResearch','ToggleMoreSettings','ToggleSidebar','FullTextSearch','DraftList','ManageDocs','ToggleFullDoc','ToggleBookLeft','ToggleBookBottom','ToggleTabsBar','ToggleAddFile','TabNextFile','TabPrevFile','ToggleSplit','BindSplit','EmphasisCloze','ToggleTextLink','SyncMindMapToBook','SyncBookToMindMap','SyncWindowPos','SyncDeletion','SetRefCopyMode','SetCloneCopyMode','UIStatusURL','BookTOC','BookPageList','BookMarkList','BookSketchList','BookCardList','EditDocLayers','ViewDocCardGroup','BookSearch','BookPageFlip','BookPageScroll','ExtendSplit','ExtendMargin','ExtendPopup','PdfCrop','BookPageNumber','GoBack','GoForward','BookMarkAdd','BookMarkRemove','EditPDFPages','AddToTOC','SplitBook','InsertBlank','Translate','FoldHighlight','SourceHighlight','EditTextBox','EditImageBox','ExcerptToolSettings','ExcerptToolSelect','ExcerptToolCustom0','ExcerptToolCustom1','ExcerptToolCustom2','ExcerptToolCustom3','HighlightShortcut1','HighlightShortcut2','HighlightShortcut3','HighlightShortcut4','ExcerptToolSketch','NotebookOutline','ViewMapCardGroup','EditMultiSel','FocusNote','FocusParent','NotebookOutlineEdit','EditOutlineIncLevel','EditOutlineDecLevel','SnippetMode','NewSiblingNote','NewChildNote','NewParentNote','ToggleExpand','EditGroupNotes','EditLinkNotes','EditMergeNotes','SelBranchStyle0','SelBranchStyle3','SelBranchStyle2','SelBranchStyle1','SelBranchStyle4','SelBranchStyle60','SelBranchStyle61','SelBranchStyle64','SelBranchStyle7','SelBranchStyle100','GlobalBranchStyle','ZoomToFit','ViewExpandAll','ViewCollapseAll','ViewExpandLevel0','ViewExpandLevel1','ViewExpandLevel2','ViewExpandLevel3','ViewExpandLevel4','ViewExpandLevel5','ViewExpandLevel6','ViewExpandLevel7','ViewExpandRows','ViewCollapseRows','EditArrangeNotes','MindmapSnippetMode','SelectBranch','ShowSketch','HideSketch','EditCopy','EditReference','EditCopyLink','EditDeleteNote','EditColorNoteIndex0','EditColorNoteIndex1','EditColorNoteIndex2','EditColorNoteIndex3','EditColorNoteIndex4','EditColorNoteIndex5','EditColorNoteIndex6','EditColorNoteIndex7','EditColorNoteIndex8','EditColorNoteIndex9','EditColorNoteIndex10','EditColorNoteIndex11','EditColorNoteIndex12','EditColorNoteIndex13','EditColorNoteIndex14','EditColorNoteIndex15','EditTagNote','EditAddTitle','EditAddText','EditAppendComment','ContinueExcerpt','EditTextMode','EditOcclusion','EditUnmergeNote','TextToTitle','ExpandExtend','CollapseExtend','SendToMap','RemoveFromMap','AddToReview','ClearFormat1','ClearFormat2','FlashcardSpeech','SetTitleHighlight','SetCommentHighlight','SetAsEmphasis','MergeTo','FlashcardsPlay','FlashcardsStop','FlashcardFlip','FlashcardLocal','FlashcardAgain','FlashcardHard','FlashcardGood','FlashcardEasy','FlashcardStarred']
              case 'color':
                return ['parent','current']
              case 'type':
                return ['TextNote','HtmlNote','PaintNote','LinkNote']
              default:
                break;
            }
            return [];
          }
          return []
        }
      }
        }

        const editor = new JSONEditor(container, options)

        // set json
        const initialJson = {}
        const initialJson0 = {
  "action": "menu",
  "menuItems": [
    "👇🏻👇🏻👇🏻👇🏻编辑卡片",
    {
      "menuTitle": "1.开关MD",
      "action": "mergeText",
      "target": "excerptText",
      "source": [
        "{{excerptTexts}}",
        "{{textComments}}"
      ],
      "removeSource": true,
      "onFinish": {
        "action": "toggleMarkdown"
      }
    },
    {
      "menuTitle": "2.粘贴为评论",
      "action": "paste",
      "target": "default"
    },
    {
      "menuTitle": "3.粘贴为追加摘录",
      "action": "paste",
      "target": "appendExcerpt"
    },
    "👇🏻👇🏻👇🏻👇🏻格式卡片",
    {
      "menuTitle": "1.清除格式",
      "action": "command",
      "command": "ClearFormat1"
    },
    {
      "menuTitle": "2.评论转摘录",
      "action": "mergeText",
      "target": "excerptText",
      "source": [
        "{{excerptTexts}}",
        "{{textComments}}"
      ],
      "removeSource": true
    },
    {
      "menuTitle": "3.转换标题",
      "action": "switchTitleOrExcerpt"
    },
    "👇🏻👇🏻👇🏻👇🏻学习卡片",
    {
      "menuTitle": "1.开始复习",
      "action": "command",
      "command": "FlashcardsPlay"
    },
    {
      "menuTitle": "2.结束复习",
      "action": "command",
      "command": "FlashcardsStop"
    },
    {
      "menuTitle": "3.小窗显示卡片",
      "action": "focus",
      "target": "floatMindmap"
    },
    "👇🏻👇🏻👇🏻👇🏻系统设置",
    {
      "menuTitle": "1.开关工具栏",
      "action": "toggleView",
      "targets": [
        "addonBar",
        "mindmapToolbar"
      ]
    },
    {
      "menuTitle": "2.强制退出",
      "action": "crash"
    }
  ]
}

        editor.set(initialJson)

        // get json
        const updatedJson = editor.get()
        function updateContent(data) {
          let tem = decodeURIComponent(data)
          // MNUtil.copy(tem)
          editor.update(JSON.parse(tem))
          setTimeout(() => {
            editor.expandAll()
          }, 100);
        }
        function setContent(data) {
          let tem = decodeURIComponent(data)
          // MNUtil.copy(tem)
          editor.set(JSON.parse(tem))
          editor.expandAll()
          adjustSelectWidth()
        }
        function getContent() {
          let tem = JSON.stringify(editor.get(),null,2)
          removeFocus()
          return encodeURIComponent(tem)
        }
        function removeFocus() {
          document.activeElement.blur(); // 先尝试失去当前焦点
          // document.body.focus(); // 将焦点设置到 body
        }
        window.addEventListener('resize', adjustSelectWidth);
    </script>
</body>
</html>