{
  "currentState": "initialized",
  "stateHistory": [
    {
      "from": "initial",
      "command": "init",
      "timestamp": "2025-06-28T12:03:19.937Z",
      "args": [
        {
          "workingDirectory": "/Users/xiakangwei/Nutstore/Github/repository/MN-addon-develop/MN-Addon"
        }
      ]
    },
    {
      "from": "initialized",
      "command": "remember",
      "timestamp": "2025-06-28T12:35:43.405Z",
      "args": [
        "## MarginNote æ’ä»¶å¼€å‘è¸©å‘è®°å½• (MNTask 2025-06-28)\n\n### 1. MarginNote å®Œå…¨å¡æ­»é—®é¢˜\n- åŸå› ï¼šJSB.newAddon ç¼ºå°‘ mainPath å‚æ•°ï¼›ä½¿ç”¨ new TaskController() è€Œé TaskController.new()ï¼›æ¨¡å—åŠ è½½å¾ªç¯ä¾èµ–\n- è§£å†³ï¼šå¿…é¡»æ¥æ”¶ mainPathï¼›ä½¿ç”¨ .new() åˆ›å»º JSB å¯¹è±¡ï¼›å»¶è¿ŸåŠ è½½ä¾èµ–æ¨¡å—\n\n### 2. æ’ä»¶ä¸åœ¨æ’ä»¶æ æ˜¾ç¤º  \n- åŸå› ï¼šç¼ºå°‘ queryAddonCommandStatus æ–¹æ³•ï¼›ç¼ºå°‘é™æ€æ–¹æ³•å¯¹è±¡ï¼›å›¾æ ‡å°ºå¯¸é”™è¯¯\n- è§£å†³ï¼šå®ç° queryAddonCommandStatus è¿”å›å›¾æ ‡é…ç½®ï¼›JSB.defineClass éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼ˆå®ä¾‹+é™æ€ï¼‰ï¼›logo.png å¿…é¡»æ˜¯ 44x44\n\n### 3. toggleAddon æ— å“åº”\n- åŸå› ï¼šJavaScript ä½œç”¨åŸŸé—®é¢˜ï¼›self æœªå®šä¹‰\n- è§£å†³ï¼šåœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰ var self = nullï¼›åœ¨ sceneWillConnect ä¸­è®¾ç½® self = this\n\n### 4. å…¶ä»–é‡è¦ç»éªŒ\n- UIAlertView ä¸å¯é ï¼Œä½¿ç”¨ MNUtil.input\n- å§‹ç»ˆæ£€æŸ¥ typeof MNUtil !== \"undefined\"\n- ä½¿ç”¨ UIWebView è€Œé WKWebView\n- æ¯ä¸ªå±é™©æ“ä½œéƒ½è¦ try-catch\n- å‚è€ƒ mntoolbar å’Œ mnutils çš„å®ç°æ¨¡å¼\n\n### å¼€å‘æ£€æŸ¥æ¸…å•\nâœ“ JSB.newAddon(mainPath)\nâœ“ queryAddonCommandStatus æ–¹æ³•\nâœ“ JSB.defineClass ä¸¤ä¸ªå‚æ•°\nâœ“ sceneWillConnect ä¸­ self = this\nâœ“ MNUtil å­˜åœ¨æ€§æ£€æŸ¥\nâœ“ ä½¿ç”¨ .new() åˆ›å»ºå¯¹è±¡\nâœ“ logo.png 44x44 åƒç´ ",
        "--tags",
        "marginnote plugin development mntask troubleshooting jsb"
      ]
    },
    {
      "from": "memory_saved",
      "command": "recall",
      "timestamp": "2025-06-28T12:37:18.579Z",
      "args": []
    },
    {
      "from": "recall-waiting",
      "command": "remember",
      "timestamp": "2025-06-28T12:59:27.730Z",
      "args": [
        "## MarginNote æ’ä»¶é—ªé€€é—®é¢˜ç»ˆæè§£å†³æ–¹æ¡ˆ (MNTask 2025-06-28)\n\n### é—®é¢˜ï¼šå®‰è£…æ’ä»¶å MarginNote4 å®Œå…¨é—ªé€€ï¼Œé‡å¯ä»ç„¶é—ªé€€\n\n### æ ¹æœ¬åŸå› ï¼š\n1. **æ¨¡å—åŠ è½½æ—¶æœºé”™è¯¯** - åœ¨ JSB.newAddon å‡½æ•°å†…éƒ¨åŠ è½½æ¨¡å—ä¼šå¯¼è‡´é—ªé€€\n2. **ES6 è¯­æ³•å…¼å®¹æ€§** - è™½ç„¶ MNUtils ä½¿ç”¨äº† classï¼Œä½†åœ¨æ’ä»¶åˆå§‹åŒ–é˜¶æ®µä½¿ç”¨å¯èƒ½æœ‰é—®é¢˜\n\n### è§£å†³æ–¹æ¡ˆï¼š\n\n1. **å°†æ¨¡å—åŠ è½½ç§»åˆ°æ–‡ä»¶æœ«å°¾**ï¼ˆæœ€å…³é”®ï¼‰ï¼š\n```javascript\n// âŒ é”™è¯¯ - åœ¨ JSB.newAddon å†…éƒ¨åŠ è½½\nJSB.newAddon = function(mainPath) {\n  JSB.require('taskModel');  // å¯¼è‡´é—ªé€€ï¼\n  // ...\n}\n\n// âœ… æ­£ç¡® - åœ¨æ–‡ä»¶æœ«å°¾åŠ è½½\nJSB.newAddon = function(mainPath) {\n  // åªå®šä¹‰ç±»ï¼Œä¸åŠ è½½æ¨¡å—\n  return MNTaskMain;\n};\n\n// æ–‡ä»¶æœ«å°¾\nJSB.require('mnutils');\nJSB.require('taskModel');\nJSB.require('taskController');\n```\n\n2. **ES6 class æ”¹ä¸ºä¼ ç»Ÿå‡½æ•°å¼**ï¼š\n```javascript\n// âŒ å¯èƒ½æœ‰é—®é¢˜\nclass TaskModel { }\n\n// âœ… æ›´å®‰å…¨\nfunction TaskModel() { }\nTaskModel.prototype.method = function() { }\n```\n\n3. **ç§»é™¤å±é™©çš„çˆ¶ç±»è°ƒç”¨**ï¼š\n```javascript\n// âŒ é”™è¯¯\nself.super.init();\n\n// âœ… ç›´æ¥åˆå§‹åŒ–\n// ä¸è°ƒç”¨çˆ¶ç±»\n```\n\n### è°ƒè¯•æŠ€å·§ï¼š\n- ä½¿ç”¨ Console.app æŸ¥çœ‹å´©æºƒæ—¥å¿—\n- é€æ­¥æ’é™¤æ³•ï¼šå…ˆåˆ›å»ºæœ€ç®€å•çš„æ’ä»¶ï¼Œé€æ­¥æ·»åŠ åŠŸèƒ½\n- å¯¹æ¯”æˆåŠŸè¿è¡Œçš„æ’ä»¶ï¼ˆå¦‚ MNToolbarï¼‰çš„ç»“æ„\n\n### å…³é”®ç»éªŒï¼š\n- MarginNote çš„ JSB ç¯å¢ƒåœ¨ä¸åŒé˜¶æ®µå¯¹ JS ç‰¹æ€§çš„æ”¯æŒä¸åŒ\n- æ¨¡å—åŠ è½½é¡ºåºæå…¶é‡è¦ï¼Œå¿…é¡»åœ¨æ–‡ä»¶æœ«å°¾åŠ è½½\n- å‚è€ƒæˆåŠŸæ’ä»¶çš„æ¨¡å¼ï¼Œä¸è¦åˆ›æ–°",
        "--tags",
        "marginnote plugin crash mntask troubleshooting jsb module-loading"
      ]
    },
    {
      "from": "memory_saved",
      "command": "remember",
      "timestamp": "2025-06-28T13:06:21.873Z",
      "args": [
        "## MarginNote æ’ä»¶é—ªé€€é—®é¢˜æ·±åº¦åˆ†æ (2025-06-28)\n\n### é—®é¢˜ç±»å‹ï¼šåº”ç”¨é—ªé€€ vs åº”ç”¨å¡æ­»\n- **é—ªé€€**ï¼šMarginNote ç›´æ¥å´©æºƒé€€å‡ºï¼Œé‡å¯ä»ç„¶é—ªé€€ï¼ˆæœ¬æ¬¡é‡åˆ°çš„é—®é¢˜ï¼‰\n- **å¡æ­»**ï¼šMarginNote æ— å“åº”ä½†ä¸é€€å‡ºï¼Œéœ€è¦å¼ºåˆ¶é€€å‡º\n\n### é—ªé€€æ ¹æœ¬åŸå› ï¼šæ¨¡å—åŠ è½½æ—¶æœºé”™è¯¯ ğŸš¨\n\n**æœ€å…³é”®å‘ç°**ï¼šMarginNote çš„ JSB ç¯å¢ƒå¯¹æ¨¡å—åŠ è½½æ—¶æœºæå…¶æ•æ„Ÿï¼\n\n```javascript\n// âŒ è‡´å‘½é”™è¯¯ - åœ¨ JSB.newAddon å†…éƒ¨åŠ è½½æ¨¡å—\nJSB.newAddon = function(mainPath) {\n  JSB.require('taskModel');     // ğŸ’¥ å¯¼è‡´é—ªé€€ï¼\n  JSB.require('taskController'); // ğŸ’¥ å¯¼è‡´é—ªé€€ï¼\n  \n  var Plugin = JSB.defineClass(...);\n  return Plugin;\n};\n\n// âœ… æ­£ç¡®åšæ³• - æ–‡ä»¶æœ«å°¾åŠ è½½\nJSB.newAddon = function(mainPath) {\n  var Plugin = JSB.defineClass(...);\n  return Plugin;  // åªè¿”å›ç±»å®šä¹‰\n};\n\n// æ‰€æœ‰æ¨¡å—åŠ è½½å¿…é¡»åœ¨æ–‡ä»¶æœ«å°¾\nJSB.require('mnutils');\nJSB.require('taskModel');\nJSB.require('taskController');\n```\n\n### ä¸ºä»€ä¹ˆä¼šé—ªé€€ï¼Ÿ\n1. JSB.newAddon åœ¨æ’ä»¶åˆå§‹åŒ–çš„æ—©æœŸé˜¶æ®µæ‰§è¡Œ\n2. æ­¤æ—¶ JSB ç¯å¢ƒå¯èƒ½è¿˜æœªå®Œå…¨å‡†å¤‡å¥½\n3. åŠ è½½åŒ…å«ç‰¹å®šè¯­æ³•çš„æ¨¡å—ä¼šè§¦å‘å´©æºƒ\n4. æˆåŠŸè¿è¡Œçš„æ’ä»¶ï¼ˆMNToolbarã€MNUtilsï¼‰éƒ½åœ¨æ–‡ä»¶æœ«å°¾åŠ è½½æ¨¡å—\n\n### å…¶ä»–å¯¼è‡´é—ªé€€çš„å› ç´ \n1. **ES6 è¯­æ³•**ï¼šè™½ç„¶ MNUtils ä½¿ç”¨ classï¼Œä½†åœ¨æ’ä»¶åˆå§‹åŒ–é˜¶æ®µä½¿ç”¨å¯èƒ½å¯¼è‡´é—ªé€€\n2. **çˆ¶ç±»è°ƒç”¨**ï¼šé”™è¯¯çš„ super.init() è°ƒç”¨\n3. **å¾ªç¯ä¾èµ–**ï¼šæ¨¡å—é—´çš„å¾ªç¯å¼•ç”¨\n\n### è°ƒè¯•é—ªé€€çš„æ–¹æ³•\n1. ä½¿ç”¨ Console.app æŸ¥çœ‹å´©æºƒæ—¥å¿—\n2. æœç´¢ \"marginnote\" ç›¸å…³æ¡ç›®\n3. é€æ­¥æ’é™¤æ³•ï¼šä»æœ€ç®€å•çš„æ’ä»¶å¼€å§‹ï¼Œé€æ­¥æ·»åŠ åŠŸèƒ½\n4. å¯¹æ¯”æˆåŠŸæ’ä»¶çš„ä»£ç ç»“æ„\n\n### é¢„é˜²é—ªé€€çš„æœ€ä½³å®è·µ\n1. **ä¸¥æ ¼éµå®ˆæ¨¡å—åŠ è½½è§„åˆ™**ï¼šæ‰€æœ‰ JSB.require å¿…é¡»åœ¨æ–‡ä»¶æœ«å°¾\n2. **JSB.newAddon ä¿æŒçº¯å‡€**ï¼šåªå®šä¹‰å’Œè¿”å›ç±»ï¼Œä¸æ‰§è¡Œä»»ä½•å…¶ä»–æ“ä½œ\n3. **é¿å…é«˜çº§è¯­æ³•**ï¼šåœ¨æ’ä»¶åˆå§‹åŒ–é˜¶æ®µä½¿ç”¨ä¼ ç»Ÿè¯­æ³•\n4. **å‚è€ƒæˆåŠŸæ¡ˆä¾‹**ï¼šä»¥ MNToolbar ä¸ºæ¨¡æ¿è¿›è¡Œå¼€å‘\n\n### é—ªé€€ vs å¡æ­»çš„åŒºåˆ«å¤„ç†\n- é—ªé€€ï¼šæ£€æŸ¥æ¨¡å—åŠ è½½æ—¶æœºã€è¯­æ³•å…¼å®¹æ€§\n- å¡æ­»ï¼šæ£€æŸ¥æ­»å¾ªç¯ã€æ— é™é€’å½’ã€åŒæ­¥é˜»å¡æ“ä½œ",
        "--tags",
        "marginnote plugin crash debugging jsb module-loading best-practices"
      ]
    },
    {
      "from": "memory_saved",
      "command": "recall",
      "timestamp": "2025-06-28T13:07:03.740Z",
      "args": []
    },
    {
      "from": "recall-waiting",
      "command": "init",
      "timestamp": "2025-06-28T13:49:21.530Z",
      "args": [
        {
          "workingDirectory": "/Users/xiakangwei/Nutstore/Github/repository/MN-addon-develop/MN-Addon"
        }
      ]
    },
    {
      "from": "initialized",
      "command": "init",
      "timestamp": "2025-06-28T14:37:33.903Z",
      "args": [
        {
          "workingDirectory": "/Users/xiakangwei/Nutstore/Github/repository/MN-addon-develop/MN-Addon"
        }
      ]
    },
    {
      "from": "initialized",
      "command": "init",
      "timestamp": "2025-06-28T15:14:04.647Z",
      "args": [
        {
          "workingDirectory": "/Users/xiakangwei/Nutstore/Github/repository/MN-addon-develop/MN-Addon"
        }
      ]
    },
    {
      "from": "initialized",
      "command": "init",
      "timestamp": "2025-06-28T15:27:44.964Z",
      "args": [
        {
          "workingDirectory": "/Users/xiakangwei/Nutstore/Github/repository/MN-addon-develop/MN-Addon"
        }
      ]
    }
  ],
  "lastUpdated": "2025-06-28T15:27:44.988Z"
}
