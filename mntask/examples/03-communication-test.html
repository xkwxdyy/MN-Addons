<!DOCTYPE html>
<html>
<head>
    <title>é€šä¿¡æµ‹è¯•</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            text-align: center;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        button {
            background-color: #007aff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #0051d5;
        }
        
        .message-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 8px;
            min-height: 50px;
        }
        
        .log {
            text-align: left;
            margin-top: 20px;
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            background-color: white;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“¡ é€šä¿¡æµ‹è¯•é¡µé¢</h1>
        <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºç½‘é¡µå¦‚ä½•ä¸æ’ä»¶é€šä¿¡</p>
        
        <h3>1. å‘é€æ¶ˆæ¯åˆ°æ’ä»¶</h3>
        <button onclick="sendToPlugin('æ‰“æ‹›å‘¼')">ğŸ‘‹ æ‰“æ‹›å‘¼</button>
        <button onclick="sendToPlugin('è¯·æ±‚æ•°æ®')">ğŸ“Š è¯·æ±‚æ•°æ®</button>
        <button onclick="sendToPlugin('ä¿å­˜è®¾ç½®')">ğŸ’¾ ä¿å­˜è®¾ç½®</button>
        
        <h3>2. æ¥æ”¶æ’ä»¶çš„æ¶ˆæ¯</h3>
        <div class="message-box" id="messageBox">
            ç­‰å¾…æ’ä»¶çš„æ¶ˆæ¯...
        </div>
        
        <h3>3. é€šä¿¡æ—¥å¿—</h3>
        <div class="log" id="log"></div>
    </div>
    
    <script>
        // =====================================
        // ğŸ“š é€šä¿¡æµ‹è¯•é¡µé¢ - å­¦ä¹ ç¬”è®°
        // 
        // è¿™ä¸ªé¡µé¢å±•ç¤ºäº†ç½‘é¡µä¸æ’ä»¶é€šä¿¡çš„åŸºæœ¬åŸç†
        // åœ¨çœŸå®çš„æ’ä»¶ç¯å¢ƒä¸­è¿è¡Œæ—¶ï¼š
        // 1. ç‚¹å‡»æŒ‰é’®ä¼šå‘é€ URL Scheme åˆ°æ’ä»¶
        // 2. æ’ä»¶ä¼šè°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°è¿”å›æ•°æ®
        // 
        // åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•æ—¶ï¼š
        // - æˆ‘ä»¬æ¨¡æ‹Ÿäº†æ’ä»¶çš„å“åº”
        // - å¯ä»¥çœ‹åˆ°é€šä¿¡çš„å®Œæ•´æµç¨‹
        // =====================================
        
        // æ·»åŠ æ—¥å¿—çš„å‡½æ•°
        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            
            // æ ¹æ®ç±»å‹é€‰æ‹©å›¾æ ‡
            const icon = type === 'send' ? 'ğŸ“¤' : 'ğŸ“¥';
            
            entry.innerHTML = `${icon} [${time}] ${message}`;
            log.appendChild(entry);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            log.scrollTop = log.scrollHeight;
        }
        
        // å‘é€æ¶ˆæ¯åˆ°æ’ä»¶
        function sendToPlugin(action) {
            // è®°å½•æ—¥å¿—
            addLog(`å‘é€æ¶ˆæ¯: ${action}`, 'send');
            
            // æ„é€ ç‰¹æ®Šçš„ URL
            // mntask:// æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰åè®®
            // æ’ä»¶ä¼šæ‹¦æˆªè¿™ç§ URL
            const url = `mntask://${action}?time=${Date.now()}`;
            
            // æ˜¾ç¤º URLï¼ˆå¸®åŠ©ç†è§£ï¼‰
            console.log('æ„é€ çš„ URL:', url);
            
            // å‘é€ï¼ˆåœ¨çœŸå®æ’ä»¶ä¸­ï¼Œè¿™ä¼šè¢«æ’ä»¶æ‹¦æˆªï¼‰
            window.location.href = url;
            
            // æ¨¡æ‹Ÿæ•ˆæœï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼‰
            // åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæ’ä»¶ä¼šè°ƒç”¨ receiveFromPlugin
            setTimeout(() => {
                simulatePluginResponse(action);
            }, 1000);
        }
        
        // æ¥æ”¶æ’ä»¶çš„æ¶ˆæ¯
        // è¿™ä¸ªå‡½æ•°ä¼šè¢«æ’ä»¶è°ƒç”¨
        function receiveFromPlugin(message) {
            // è®°å½•æ—¥å¿—
            addLog(`æ”¶åˆ°æ¶ˆæ¯: ${message}`, 'receive');
            
            // æ›´æ–°æ˜¾ç¤º
            const messageBox = document.getElementById('messageBox');
            messageBox.innerHTML = `âœ… æ”¶åˆ°æ’ä»¶æ¶ˆæ¯ï¼š<br><strong>${message}</strong>`;
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            messageBox.style.transform = 'scale(1.05)';
            setTimeout(() => {
                messageBox.style.transform = 'scale(1)';
            }, 200);
        }
        
        // æ¨¡æ‹Ÿæ’ä»¶å“åº”ï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼‰
        function simulatePluginResponse(action) {
            let response = '';
            
            switch(action) {
                case 'æ‰“æ‹›å‘¼':
                    response = 'ä½ å¥½ï¼æˆ‘æ˜¯æ’ä»¶ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼';
                    break;
                case 'è¯·æ±‚æ•°æ®':
                    response = 'è¿™æ˜¯ä»»åŠ¡æ•°æ®ï¼š[ä»»åŠ¡1, ä»»åŠ¡2, ä»»åŠ¡3]';
                    break;
                case 'ä¿å­˜è®¾ç½®':
                    response = 'è®¾ç½®å·²ä¿å­˜æˆåŠŸï¼';
                    break;
                default:
                    response = 'æœªçŸ¥çš„å‘½ä»¤ï¼š' + action;
            }
            
            // è°ƒç”¨æ¥æ”¶å‡½æ•°ï¼Œæ¨¡æ‹Ÿæ’ä»¶è°ƒç”¨
            receiveFromPlugin(response);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.onload = function() {
            addLog('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡é€šä¿¡', 'info');
            
            // æ˜¾ç¤ºæç¤º
            console.log('ğŸ’¡ æç¤ºï¼šæ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹æ›´å¤šä¿¡æ¯');
            console.log('ğŸ“Œ åœ¨çœŸå®æ’ä»¶ç¯å¢ƒä¸­ï¼ŒURL Scheme ä¼šè¢«æ’ä»¶æ‹¦æˆª');
            console.log('ğŸ¯ è¯•è¯•åœ¨æ§åˆ¶å°è¾“å…¥: receiveFromPlugin("æ¥è‡ªæ§åˆ¶å°çš„æ¶ˆæ¯")');
        };
        
        // =====================================
        // ğŸ“ å­¦ä¹ è¦ç‚¹ï¼š
        // 
        // 1. URL Scheme é€šä¿¡ï¼ˆç½‘é¡µâ†’æ’ä»¶ï¼‰
        //    - ä½¿ç”¨ window.location.href = 'mntask://...'
        //    - æ’ä»¶ä¼šæ‹¦æˆªè¿™ç§ç‰¹æ®Šçš„ URL
        //    - å¯ä»¥ä¼ é€’å‚æ•°ï¼Œå¦‚ ?action=save&data=123
        // 
        // 2. JavaScript æ³¨å…¥ï¼ˆæ’ä»¶â†’ç½‘é¡µï¼‰
        //    - æ’ä»¶è°ƒç”¨ webView.evaluateJavaScript()
        //    - æ‰§è¡Œç½‘é¡µä¸­çš„å‡½æ•°ï¼Œå¦‚ receiveFromPlugin()
        //    - å¯ä»¥ä¼ é€’æ•°æ®ä½œä¸ºå‡½æ•°å‚æ•°
        // 
        // 3. é€šä¿¡æµç¨‹
        //    - ç”¨æˆ·æ“ä½œ â†’ ç½‘é¡µå‘é€ URL â†’ æ’ä»¶å¤„ç†
        //    - æ’ä»¶å¤„ç† â†’ è°ƒç”¨ JS â†’ ç½‘é¡µæ›´æ–°
        // =====================================
    </script>
</body>
</html>