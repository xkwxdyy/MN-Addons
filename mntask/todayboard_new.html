<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šæ—¥ä»»åŠ¡çœ‹æ¿ - MNTask</title>
    
    <!-- å¼•å…¥é€šä¿¡æ¡¥æ¥åº“ -->
    <script src="mntask-bridge.js"></script>
    
    <style>
        /* ==================== CSS å˜é‡å®šä¹‰ ==================== */
        :root {
            /* é¢œè‰²ä¸»é¢˜ */
            --color-primary: #007aff;
            --color-primary-hover: #0063d1;
            --color-success: #34c759;
            --color-warning: #ff9500;
            --color-danger: #ff3b30;
            --color-info: #5856d6;
            
            /* èƒŒæ™¯è‰² */
            --bg-primary: #f5f5f7;
            --bg-secondary: #ffffff;
            --bg-sidebar: #fafafa;
            
            /* æ–‡å­—é¢œè‰² */
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --text-tertiary: #c7c7cc;
            
            /* è¾¹æ¡† */
            --border-color: #e5e5e7;
            --border-radius: 12px;
            --border-radius-sm: 6px;
            
            /* é˜´å½± */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.16);
            
            /* åŠ¨ç”» */
            --transition-fast: 0.2s;
            --transition-normal: 0.3s;
            
            /* å¸ƒå±€ */
            --sidebar-width: 240px;
            --header-height: 60px;
            --card-gap: 16px;
        }
        
        /* æš—è‰²æ¨¡å¼æ”¯æŒ */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1c1c1e;
                --bg-secondary: #2c2c2e;
                --bg-sidebar: #242426;
                --text-primary: #ffffff;
                --text-secondary: #8e8e93;
                --text-tertiary: #48484a;
                --border-color: #38383a;
            }
        }
        
        /* ==================== åŸºç¡€æ ·å¼é‡ç½® ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            font-size: 14px;
            overflow: hidden;
        }
        
        /* ==================== å¸ƒå±€ç»“æ„ ==================== */
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* ==================== ä¾§è¾¹æ  ==================== */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: transform var(--transition-normal) ease;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .sidebar.collapsed {
            transform: translateX(calc(-1 * var(--sidebar-width)));
        }
        
        /* ä¾§è¾¹æ å¤´éƒ¨ */
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ç­›é€‰å™¨åŒºåŸŸ */
        .filters {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }
        
        .filter-section {
            margin-bottom: 24px;
        }
        
        .filter-section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            padding-left: 4px;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            padding: 8px 4px;
            margin: 4px 0;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: background-color var(--transition-fast);
        }
        
        .filter-option:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .filter-checkbox {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            transition: all var(--transition-fast);
            position: relative;
        }
        
        .filter-checkbox:checked {
            background-color: var(--color-primary);
            border-color: var(--color-primary);
        }
        
        .filter-checkbox:checked::after {
            content: "âœ“";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .filter-label {
            flex: 1;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .filter-count {
            font-size: 12px;
            color: var(--text-tertiary);
            background-color: rgba(0, 0, 0, 0.05);
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        /* ä¾§è¾¹æ åº•éƒ¨ */
        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
        }
        
        /* ==================== ä¸»å†…å®¹åŒº ==================== */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* å¤´éƒ¨å·¥å…·æ  */
        .header {
            height: var(--header-height);
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .sidebar-toggle {
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-sm);
            transition: background-color var(--transition-fast);
        }
        
        .sidebar-toggle:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .header-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .header-stats {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-primary {
            background-color: var(--color-primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--color-primary-hover);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: transparent;
            color: var(--color-primary);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background-color: rgba(0, 122, 255, 0.1);
        }
        
        /* è§†å›¾åˆ‡æ¢ */
        .view-switcher {
            display: flex;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius-sm);
            padding: 2px;
        }
        
        .view-btn {
            padding: 6px 12px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 4px;
            transition: all var(--transition-fast);
            color: var(--text-secondary);
        }
        
        .view-btn.active {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            box-shadow: var(--shadow-sm);
        }
        
        /* ==================== ä»»åŠ¡æ˜¾ç¤ºåŒºåŸŸ ==================== */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }
        
        /* ä»»åŠ¡ç½‘æ ¼ */
        .task-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--card-gap);
            animation: fadeIn var(--transition-normal) ease;
        }
        
        /* ä»»åŠ¡åˆ—è¡¨è§†å›¾ */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        /* ==================== ä»»åŠ¡å¡ç‰‡ ==================== */
        .task-card {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-fast);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .task-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .task-card.completed {
            opacity: 0.7;
        }
        
        .task-card.overdue::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background-color: var(--color-danger);
        }
        
        /* ä»»åŠ¡å¡ç‰‡å¤´éƒ¨ */
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .task-type-badge {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .type-ç›®æ ‡ {
            background-color: rgba(0, 122, 255, 0.1);
            color: var(--color-primary);
        }
        
        .type-é¡¹ç›® {
            background-color: rgba(88, 86, 214, 0.1);
            color: var(--color-info);
        }
        
        .type-ä»»åŠ¡ {
            background-color: rgba(52, 199, 89, 0.1);
            color: var(--color-success);
        }
        
        .type-åŠ¨ä½œ {
            background-color: rgba(255, 149, 0, 0.1);
            color: var(--color-warning);
        }
        
        .task-status-icon {
            font-size: 20px;
        }
        
        /* ä»»åŠ¡æ ‡é¢˜ */
        .task-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* ä»»åŠ¡å…ƒä¿¡æ¯ */
        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .task-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* è¿›åº¦æ¡ */
        .task-progress {
            margin: 12px 0;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .progress-bar {
            height: 6px;
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--color-success);
            transition: width var(--transition-normal) ease;
        }
        
        /* ä»»åŠ¡æ“ä½œ */
        .task-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }
        
        .task-action-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background-color: transparent;
            border-radius: var(--border-radius-sm);
            font-size: 13px;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        
        .task-action-btn:hover {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }
        
        /* ==================== åŠ è½½å’Œç©ºçŠ¶æ€ ==================== */
        .loading-container, .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: var(--text-secondary);
        }
        
        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border-color);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        
        .empty-message {
            font-size: 14px;
            text-align: center;
            max-width: 300px;
        }
        
        /* ==================== åŠ¨ç”» ==================== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn var(--transition-normal) ease;
        }
        
        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 768px) {
            :root {
                --sidebar-width: 280px;
                --header-height: 50px;
            }
            
            .sidebar {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 100;
                box-shadow: var(--shadow-lg);
            }
            
            .sidebar-backdrop {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.3);
                z-index: 99;
                display: none;
            }
            
            .sidebar-backdrop.show {
                display: block;
            }
            
            .task-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 0 16px;
            }
            
            .content-area {
                padding: 16px;
            }
        }
        
        /* ==================== å·¥å…·ç±» ==================== */
        .text-truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .hidden {
            display: none !important;
        }
        
        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 16px; }
        .mt-3 { margin-top: 24px; }
        
        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 16px; }
        .mb-3 { margin-bottom: 24px; }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">
                    <span>ğŸ¯</span>
                    <span>ç­›é€‰å™¨</span>
                </h2>
            </div>
            
            <div class="filters">
                <!-- çŠ¶æ€ç­›é€‰ -->
                <div class="filter-section">
                    <h3 class="filter-section-title">ä»»åŠ¡çŠ¶æ€</h3>
                    <div id="statusFilters">
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-status-notstarted" checked>
                            <label for="filter-status-notstarted" class="filter-label">
                                <span>ğŸ”µ æœªå¼€å§‹</span>
                                <span class="filter-count" data-status="æœªå¼€å§‹">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-status-inprogress" checked>
                            <label for="filter-status-inprogress" class="filter-label">
                                <span>ğŸŸ¡ è¿›è¡Œä¸­</span>
                                <span class="filter-count" data-status="è¿›è¡Œä¸­">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-status-completed">
                            <label for="filter-status-completed" class="filter-label">
                                <span>ğŸŸ¢ å·²å®Œæˆ</span>
                                <span class="filter-count" data-status="å·²å®Œæˆ">0</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- ç±»å‹ç­›é€‰ -->
                <div class="filter-section">
                    <h3 class="filter-section-title">ä»»åŠ¡ç±»å‹</h3>
                    <div id="typeFilters">
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-type-goal" checked>
                            <label for="filter-type-goal" class="filter-label">
                                <span>ğŸ¯ ç›®æ ‡</span>
                                <span class="filter-count" data-type="ç›®æ ‡">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-type-project" checked>
                            <label for="filter-type-project" class="filter-label">
                                <span>ğŸ“ é¡¹ç›®</span>
                                <span class="filter-count" data-type="é¡¹ç›®">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-type-task" checked>
                            <label for="filter-type-task" class="filter-label">
                                <span>ğŸ“‹ ä»»åŠ¡</span>
                                <span class="filter-count" data-type="ä»»åŠ¡">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-type-action" checked>
                            <label for="filter-type-action" class="filter-label">
                                <span>âš¡ åŠ¨ä½œ</span>
                                <span class="filter-count" data-type="åŠ¨ä½œ">0</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- ä¼˜å…ˆçº§ç­›é€‰ -->
                <div class="filter-section">
                    <h3 class="filter-section-title">ä¼˜å…ˆçº§</h3>
                    <div id="priorityFilters">
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-priority-high" checked>
                            <label for="filter-priority-high" class="filter-label">
                                <span>ğŸ”´ é«˜ä¼˜å…ˆçº§</span>
                                <span class="filter-count" data-priority="é«˜">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-priority-medium" checked>
                            <label for="filter-priority-medium" class="filter-label">
                                <span>ğŸŸ¡ ä¸­ä¼˜å…ˆçº§</span>
                                <span class="filter-count" data-priority="ä¸­">0</span>
                            </label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" class="filter-checkbox" id="filter-priority-low" checked>
                            <label for="filter-priority-low" class="filter-label">
                                <span>ğŸŸ¢ ä½ä¼˜å…ˆçº§</span>
                                <span class="filter-count" data-priority="ä½">0</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <button class="btn btn-secondary" style="width: 100%;" onclick="resetFilters()">
                    ğŸ”„ é‡ç½®ç­›é€‰
                </button>
            </div>
        </aside>
        
        <!-- ç§»åŠ¨ç«¯ä¾§è¾¹æ èƒŒæ™¯ -->
        <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="toggleSidebar()"></div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content">
            <!-- å¤´éƒ¨å·¥å…·æ  -->
            <header class="header">
                <div class="header-left">
                    <button class="sidebar-toggle" onclick="toggleSidebar()">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                    <h1 class="header-title">ä»Šæ—¥ä»»åŠ¡çœ‹æ¿</h1>
                    <span class="header-stats" id="headerStats">å…± 0 ä¸ªä»»åŠ¡</span>
                </div>
                
                <div class="header-right">
                    <!-- è§†å›¾åˆ‡æ¢ -->
                    <div class="view-switcher">
                        <button class="view-btn active" data-view="grid" onclick="switchView('grid')">
                            ç½‘æ ¼
                        </button>
                        <button class="view-btn" data-view="list" onclick="switchView('list')">
                            åˆ—è¡¨
                        </button>
                    </div>
                    
                    <!-- åˆ·æ–°æŒ‰é’® -->
                    <button class="btn btn-primary" onclick="refreshTasks()">
                        <span>ğŸ”„</span>
                        <span>åˆ·æ–°</span>
                    </button>
                </div>
            </header>
            
            <!-- å†…å®¹åŒºåŸŸ -->
            <div class="content-area" id="contentArea">
                <!-- åˆå§‹åŠ è½½çŠ¶æ€ -->
                <div class="loading-container" id="loadingContainer">
                    <div class="loading-spinner"></div>
                    <p>æ­£åœ¨åŠ è½½ä»»åŠ¡æ•°æ®...</p>
                </div>
                
                <!-- ç©ºçŠ¶æ€ï¼ˆé»˜è®¤éšè—ï¼‰ -->
                <div class="empty-state hidden" id="emptyState">
                    <div class="empty-icon">ğŸ“­</div>
                    <h2 class="empty-title">æ²¡æœ‰æ‰¾åˆ°ä»»åŠ¡</h2>
                    <p class="empty-message">
                        ä»Šå¤©è¿˜æ²¡æœ‰å®‰æ’ä»»åŠ¡ï¼Œæˆ–è€…æ‰€æœ‰ä»»åŠ¡éƒ½è¢«ç­›é€‰æ‰äº†ã€‚
                        å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æ·»åŠ æ–°ä»»åŠ¡ã€‚
                    </p>
                </div>
                
                <!-- ä»»åŠ¡å®¹å™¨ï¼ˆé»˜è®¤éšè—ï¼‰ -->
                <div class="task-grid hidden" id="taskContainer"></div>
            </div>
        </main>
    </div>
    
    <script>
        /**
         * ä»Šæ—¥ä»»åŠ¡çœ‹æ¿ä¸»ç¨‹åº
         * @module TodayBoard
         * @description 
         * è¿™æ˜¯ä»Šæ—¥ä»»åŠ¡çœ‹æ¿çš„ä¸»è¦ JavaScript ä»£ç ã€‚
         * è´Ÿè´£ä»»åŠ¡çš„æ˜¾ç¤ºã€ç­›é€‰ã€äº¤äº’ç­‰æ‰€æœ‰åŠŸèƒ½ã€‚
         */
        
        // ==================== å…¨å±€å˜é‡ ====================
        
        /**
         * åº”ç”¨çŠ¶æ€ç®¡ç†
         * @namespace
         */
        const AppState = {
            /** @type {Array<Object>} æ‰€æœ‰ä»»åŠ¡æ•°æ® */
            allTasks: [],
            
            /** @type {Array<Object>} ç­›é€‰åçš„ä»»åŠ¡ */
            filteredTasks: [],
            
            /** @type {string} å½“å‰è§†å›¾æ¨¡å¼ (grid/list) */
            currentView: 'grid',
            
            /** @type {boolean} æ˜¯å¦æ­£åœ¨åŠ è½½ */
            isLoading: false,
            
            /** @type {Object} ç­›é€‰å™¨çŠ¶æ€ */
            filters: {
                statuses: new Set(['æœªå¼€å§‹', 'è¿›è¡Œä¸­']),
                types: new Set(['ç›®æ ‡', 'é¡¹ç›®', 'ä»»åŠ¡', 'åŠ¨ä½œ']),
                priorities: new Set(['é«˜', 'ä¸­', 'ä½'])
            }
        };
        
        /**
         * é…ç½®é€‰é¡¹
         * @namespace
         */
        const Config = {
            /** @type {boolean} æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ */
            debug: true,
            
            /** @type {number} åŠ¨ç”»æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ */
            animationDuration: 300,
            
            /** @type {number} åˆ·æ–°é˜²æŠ–å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ */
            refreshDebounceDelay: 500
        };
        
        // ==================== åˆå§‹åŒ– ====================
        
        /**
         * åº”ç”¨åˆå§‹åŒ–
         * åœ¨ DOM åŠ è½½å®Œæˆåè‡ªåŠ¨æ‰§è¡Œ
         */
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ä»Šæ—¥ä»»åŠ¡çœ‹æ¿åˆå§‹åŒ–å¼€å§‹');
            
            // åˆå§‹åŒ–å„ä¸ªæ¨¡å—
            initializeFilters();
            initializeEventListeners();
            initializeBridge();
            
            // è¯·æ±‚åˆå§‹æ•°æ®
            requestTaskData();
            
            console.log('âœ… ä»Šæ—¥ä»»åŠ¡çœ‹æ¿åˆå§‹åŒ–å®Œæˆ');
        });
        
        /**
         * åˆå§‹åŒ–ç­›é€‰å™¨
         * è®¾ç½®ç­›é€‰å™¨çš„äº‹ä»¶ç›‘å¬å™¨
         */
        function initializeFilters() {
            // ä¸ºæ‰€æœ‰ç­›é€‰å™¨å¤é€‰æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', handleFilterChange);
            });
            
            console.log('ğŸ“‹ ç­›é€‰å™¨åˆå§‹åŒ–å®Œæˆ');
        }
        
        /**
         * åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
         * è®¾ç½®å…¨å±€äº‹ä»¶ç›‘å¬
         */
        function initializeEventListeners() {
            // ç›‘å¬é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // ç›‘å¬çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', debounce(handleResize, 300));
            
            console.log('ğŸ§ äº‹ä»¶ç›‘å¬å™¨åˆå§‹åŒ–å®Œæˆ');
        }
        
        /**
         * åˆå§‹åŒ–é€šä¿¡æ¡¥æ¥
         * è®¾ç½®ä¸æ’ä»¶çš„é€šä¿¡
         */
        function initializeBridge() {
            // ç›‘å¬ä»»åŠ¡æ•°æ®
            bridge.on('tasks', handleTasksReceived);
            
            // ç›‘å¬æ›´æ–°ç»“æœ
            bridge.on('updateResult', handleUpdateResult);
            
            // ç›‘å¬é”™è¯¯
            bridge.on('error', handleError);
            
            console.log('ğŸŒ‰ é€šä¿¡æ¡¥æ¥åˆå§‹åŒ–å®Œæˆ');
        }
        
        // ==================== æ•°æ®è¯·æ±‚ä¸æ¥æ”¶ ====================
        
        /**
         * è¯·æ±‚ä»»åŠ¡æ•°æ®
         * å‘æ’ä»¶è¯·æ±‚ä»Šæ—¥ä»»åŠ¡åˆ—è¡¨
         */
        function requestTaskData() {
            console.log('ğŸ“¡ è¯·æ±‚ä»»åŠ¡æ•°æ®');
            
            showLoading();
            AppState.isLoading = true;
            
            // å‘é€è¯·æ±‚
            bridge.send('requestTasks', {
                date: new Date().toISOString().split('T')[0],
                includeCompleted: true
            }).catch(error => {
                console.error('è¯·æ±‚ä»»åŠ¡å¤±è´¥ï¼š', error);
                showError('æ— æ³•åŠ è½½ä»»åŠ¡æ•°æ®');
            });
        }
        
        /**
         * å¤„ç†æ¥æ”¶åˆ°çš„ä»»åŠ¡æ•°æ®
         * @param {Array<Object>} tasks - ä»»åŠ¡æ•°ç»„
         */
        function handleTasksReceived(tasks) {
            console.log(`ğŸ“¥ æ”¶åˆ° ${tasks.length} ä¸ªä»»åŠ¡`);
            
            // ä¿å­˜ä»»åŠ¡æ•°æ®
            AppState.allTasks = tasks;
            AppState.isLoading = false;
            
            // æ›´æ–°ç­›é€‰å™¨è®¡æ•°
            updateFilterCounts();
            
            // åº”ç”¨ç­›é€‰å¹¶æ¸²æŸ“
            applyFiltersAndRender();
        }
        
        /**
         * å¤„ç†æ›´æ–°ç»“æœ
         * @param {Object} result - æ›´æ–°ç»“æœ
         */
        function handleUpdateResult(result) {
            if (result.success) {
                console.log('âœ… æ›´æ–°æˆåŠŸï¼š', result.message);
                // å¯ä»¥æ˜¾ç¤ºæˆåŠŸæç¤º
                showToast('æ“ä½œæˆåŠŸ', 'success');
            } else {
                console.error('âŒ æ›´æ–°å¤±è´¥ï¼š', result.error);
                showToast('æ“ä½œå¤±è´¥ï¼š' + result.error, 'error');
            }
        }
        
        /**
         * å¤„ç†é”™è¯¯
         * @param {Object} error - é”™è¯¯ä¿¡æ¯
         */
        function handleError(error) {
            console.error('âŒ å‘ç”Ÿé”™è¯¯ï¼š', error);
            showToast('å‘ç”Ÿé”™è¯¯ï¼š' + error.message, 'error');
        }
        
        // ==================== ç­›é€‰åŠŸèƒ½ ====================
        
        /**
         * å¤„ç†ç­›é€‰å™¨å˜åŒ–
         * @param {Event} event - å˜åŒ–äº‹ä»¶
         */
        function handleFilterChange(event) {
            const checkbox = event.target;
            const filterId = checkbox.id;
            
            // è§£æç­›é€‰å™¨ç±»å‹å’Œå€¼
            const parts = filterId.split('-');
            const filterType = parts[1]; // status, type, priority
            const filterValue = parts[2]; // notstarted, inprogress, etc.
            
            // æ˜ å°„å€¼åˆ°ä¸­æ–‡
            const valueMap = {
                'notstarted': 'æœªå¼€å§‹',
                'inprogress': 'è¿›è¡Œä¸­',
                'completed': 'å·²å®Œæˆ',
                'goal': 'ç›®æ ‡',
                'project': 'é¡¹ç›®',
                'task': 'ä»»åŠ¡',
                'action': 'åŠ¨ä½œ',
                'high': 'é«˜',
                'medium': 'ä¸­',
                'low': 'ä½'
            };
            
            const actualValue = valueMap[filterValue] || filterValue;
            
            // æ›´æ–°ç­›é€‰å™¨çŠ¶æ€
            const filterSet = filterType === 'status' ? AppState.filters.statuses :
                            filterType === 'type' ? AppState.filters.types :
                            AppState.filters.priorities;
            
            if (checkbox.checked) {
                filterSet.add(actualValue);
            } else {
                filterSet.delete(actualValue);
            }
            
            console.log(`ğŸ” ç­›é€‰å™¨å˜åŒ–ï¼š${filterType} - ${actualValue} - ${checkbox.checked ? 'é€‰ä¸­' : 'å–æ¶ˆ'}`);
            
            // åº”ç”¨ç­›é€‰å¹¶é‡æ–°æ¸²æŸ“
            applyFiltersAndRender();
        }
        
        /**
         * åº”ç”¨ç­›é€‰å™¨å¹¶æ¸²æŸ“
         */
        function applyFiltersAndRender() {
            // åº”ç”¨ç­›é€‰
            AppState.filteredTasks = filterTasks(AppState.allTasks);
            
            console.log(`ğŸ¯ ç­›é€‰ç»“æœï¼š${AppState.filteredTasks.length}/${AppState.allTasks.length} ä¸ªä»»åŠ¡`);
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats();
            
            // æ¸²æŸ“ä»»åŠ¡
            renderTasks();
        }
        
        /**
         * æ ¹æ®ç­›é€‰å™¨è¿‡æ»¤ä»»åŠ¡
         * @param {Array<Object>} tasks - åŸå§‹ä»»åŠ¡æ•°ç»„
         * @returns {Array<Object>} è¿‡æ»¤åçš„ä»»åŠ¡æ•°ç»„
         */
        function filterTasks(tasks) {
            return tasks.filter(task => {
                // æ£€æŸ¥çŠ¶æ€
                if (!AppState.filters.statuses.has(task.status)) {
                    return false;
                }
                
                // æ£€æŸ¥ç±»å‹
                if (!AppState.filters.types.has(task.type)) {
                    return false;
                }
                
                // æ£€æŸ¥ä¼˜å…ˆçº§
                const priority = task.priority || 'ä½';
                if (!AppState.filters.priorities.has(priority)) {
                    return false;
                }
                
                return true;
            });
        }
        
        /**
         * æ›´æ–°ç­›é€‰å™¨è®¡æ•°
         */
        function updateFilterCounts() {
            // ç»Ÿè®¡å„ç§ç±»å‹çš„æ•°é‡
            const counts = {
                status: {},
                type: {},
                priority: {}
            };
            
            AppState.allTasks.forEach(task => {
                // ç»Ÿè®¡çŠ¶æ€
                counts.status[task.status] = (counts.status[task.status] || 0) + 1;
                
                // ç»Ÿè®¡ç±»å‹
                counts.type[task.type] = (counts.type[task.type] || 0) + 1;
                
                // ç»Ÿè®¡ä¼˜å…ˆçº§
                const priority = task.priority || 'ä½';
                counts.priority[priority] = (counts.priority[priority] || 0) + 1;
            });
            
            // æ›´æ–° DOM
            document.querySelectorAll('.filter-count').forEach(countEl => {
                const type = countEl.dataset.status || countEl.dataset.type || countEl.dataset.priority;
                let count = 0;
                
                if (countEl.dataset.status) {
                    count = counts.status[type] || 0;
                } else if (countEl.dataset.type) {
                    count = counts.type[type] || 0;
                } else if (countEl.dataset.priority) {
                    count = counts.priority[type] || 0;
                }
                
                countEl.textContent = count;
            });
        }
        
        /**
         * é‡ç½®æ‰€æœ‰ç­›é€‰å™¨
         */
        function resetFilters() {
            // é‡ç½®ç­›é€‰å™¨çŠ¶æ€
            AppState.filters = {
                statuses: new Set(['æœªå¼€å§‹', 'è¿›è¡Œä¸­', 'å·²å®Œæˆ']),
                types: new Set(['ç›®æ ‡', 'é¡¹ç›®', 'ä»»åŠ¡', 'åŠ¨ä½œ']),
                priorities: new Set(['é«˜', 'ä¸­', 'ä½'])
            };
            
            // æ›´æ–° UI
            document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                checkbox.checked = true;
            });
            
            // é‡æ–°åº”ç”¨ç­›é€‰
            applyFiltersAndRender();
        }
        
        // ==================== ä»»åŠ¡æ¸²æŸ“ ====================
        
        /**
         * æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
         */
        function renderTasks() {
            const container = document.getElementById('taskContainer');
            const loadingEl = document.getElementById('loadingContainer');
            const emptyEl = document.getElementById('emptyState');
            
            // éšè—åŠ è½½çŠ¶æ€
            loadingEl.classList.add('hidden');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ä»»åŠ¡
            if (AppState.filteredTasks.length === 0) {
                container.classList.add('hidden');
                emptyEl.classList.remove('hidden');
                return;
            }
            
            // éšè—ç©ºçŠ¶æ€
            emptyEl.classList.add('hidden');
            
            // æ¸…ç©ºå®¹å™¨
            container.innerHTML = '';
            
            // æ ¹æ®å½“å‰è§†å›¾æ¨¡å¼è®¾ç½®ç±»å
            container.className = AppState.currentView === 'grid' ? 'task-grid' : 'task-list';
            
            // æ¸²æŸ“æ¯ä¸ªä»»åŠ¡
            AppState.filteredTasks.forEach((task, index) => {
                const taskElement = createTaskElement(task);
                
                // æ·»åŠ åŠ¨ç”»å»¶è¿Ÿ
                taskElement.style.animationDelay = `${index * 50}ms`;
                taskElement.classList.add('fade-in');
                
                container.appendChild(taskElement);
            });
            
            // æ˜¾ç¤ºå®¹å™¨
            container.classList.remove('hidden');
        }
        
        /**
         * åˆ›å»ºä»»åŠ¡å…ƒç´ 
         * @param {Object} task - ä»»åŠ¡æ•°æ®
         * @returns {HTMLElement} ä»»åŠ¡å…ƒç´ 
         */
        function createTaskElement(task) {
            const card = document.createElement('div');
            card.className = 'task-card';
            card.dataset.taskId = task.id;
            
            // æ·»åŠ çŠ¶æ€ç±»
            if (task.status === 'å·²å®Œæˆ') {
                card.classList.add('completed');
            }
            
            // æ·»åŠ è¿‡æœŸç±»
            if (task.isOverdue) {
                card.classList.add('overdue');
            }
            
            // æ„å»ºå¡ç‰‡å†…å®¹
            card.innerHTML = `
                <!-- ä»»åŠ¡å¤´éƒ¨ -->
                <div class="task-header">
                    <span class="task-type-badge type-${task.type}">${task.type}</span>
                    <span class="task-status-icon">${getStatusIcon(task.status)}</span>
                </div>
                
                <!-- ä»»åŠ¡æ ‡é¢˜ -->
                <h3 class="task-title">${escapeHtml(task.title)}</h3>
                
                <!-- ä»»åŠ¡å…ƒä¿¡æ¯ -->
                <div class="task-meta">
                    ${task.priority ? `
                        <div class="task-meta-item">
                            <span>${getPriorityIcon(task.priority)}</span>
                            <span>${task.priority}ä¼˜å…ˆçº§</span>
                        </div>
                    ` : ''}
                    
                    ${task.plannedTime ? `
                        <div class="task-meta-item">
                            <span>â±</span>
                            <span>${task.plannedTime}</span>
                        </div>
                    ` : ''}
                    
                    ${task.isOverdue ? `
                        <div class="task-meta-item" style="color: var(--color-danger);">
                            <span>âš ï¸</span>
                            <span>å·²è¿‡æœŸ ${task.overdueDays} å¤©</span>
                        </div>
                    ` : ''}
                </div>
                
                <!-- è¿›åº¦æ¡ï¼ˆå¦‚æœæœ‰ï¼‰ -->
                ${task.progress !== undefined && task.progress !== null ? `
                    <div class="task-progress">
                        <div class="progress-info">
                            <span>å®Œæˆè¿›åº¦</span>
                            <span>${task.progress}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${task.progress}%"></div>
                        </div>
                    </div>
                ` : ''}
                
                <!-- æ“ä½œæŒ‰é’® -->
                <div class="task-actions">
                    <button class="task-action-btn" onclick="updateTaskStatus('${task.id}', '${getNextStatus(task.status)}')">
                        <span>${getStatusActionIcon(task.status)}</span>
                        <span>${getStatusActionText(task.status)}</span>
                    </button>
                    
                    <button class="task-action-btn" onclick="launchTask('${task.id}')">
                        <span>ğŸš€</span>
                        <span>å¯åŠ¨</span>
                    </button>
                </div>
            `;
            
            // ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
            card.addEventListener('click', function(e) {
                // å¦‚æœç‚¹å‡»çš„æ˜¯æŒ‰é’®ï¼Œä¸è§¦å‘å¡ç‰‡ç‚¹å‡»
                if (e.target.closest('.task-action-btn')) return;
                
                viewTaskDetail(task.id);
            });
            
            return card;
        }
        
        // ==================== ä»»åŠ¡æ“ä½œ ====================
        
        /**
         * æ›´æ–°ä»»åŠ¡çŠ¶æ€
         * @param {string} taskId - ä»»åŠ¡ ID
         * @param {string} newStatus - æ–°çŠ¶æ€
         */
        function updateTaskStatus(taskId, newStatus) {
            console.log(`ğŸ“ æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼š${taskId} -> ${newStatus}`);
            
            // ä¹è§‚æ›´æ–°ï¼šç«‹å³æ›´æ–°æœ¬åœ°æ•°æ®
            const task = AppState.allTasks.find(t => t.id === taskId);
            if (task) {
                task.status = newStatus;
                
                // é‡æ–°æ¸²æŸ“
                applyFiltersAndRender();
            }
            
            // å‘é€åˆ°æ’ä»¶
            bridge.send('updateTaskStatus', {
                taskId: taskId,
                status: newStatus
            }).catch(error => {
                // å¦‚æœå¤±è´¥ï¼Œæ¢å¤åŸçŠ¶æ€
                console.error('æ›´æ–°å¤±è´¥ï¼š', error);
                
                // è¿™é‡Œåº”è¯¥æ¢å¤åŸçŠ¶æ€ï¼Œä½†éœ€è¦å…ˆä¿å­˜åŸçŠ¶æ€
                // ä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œåªåˆ·æ–°æ•°æ®
                requestTaskData();
            });
        }
        
        /**
         * å¯åŠ¨ä»»åŠ¡
         * @param {string} taskId - ä»»åŠ¡ ID
         */
        function launchTask(taskId) {
            console.log(`ğŸš€ å¯åŠ¨ä»»åŠ¡ï¼š${taskId}`);
            
            // å‘é€åˆ°æ’ä»¶
            bridge.send('launchTask', {
                taskId: taskId
            });
        }
        
        /**
         * æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…
         * @param {string} taskId - ä»»åŠ¡ ID
         */
        function viewTaskDetail(taskId) {
            console.log(`ğŸ‘ æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼š${taskId}`);
            
            // å‘é€åˆ°æ’ä»¶
            bridge.send('viewTaskDetail', {
                taskId: taskId
            });
        }
        
        /**
         * åˆ·æ–°ä»»åŠ¡
         */
        function refreshTasks() {
            console.log('ğŸ”„ åˆ·æ–°ä»»åŠ¡');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const button = event.target.closest('.btn');
            if (button) {
                button.disabled = true;
                button.innerHTML = '<span>â³</span><span>åˆ·æ–°ä¸­...</span>';
            }
            
            // è¯·æ±‚æ•°æ®
            requestTaskData();
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(() => {
                if (button) {
                    button.disabled = false;
                    button.innerHTML = '<span>ğŸ”„</span><span>åˆ·æ–°</span>';
                }
            }, 1000);
        }
        
        // ==================== UI æ§åˆ¶ ====================
        
        /**
         * åˆ‡æ¢ä¾§è¾¹æ 
         */
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('sidebarBackdrop');
            
            sidebar.classList.toggle('collapsed');
            
            // ç§»åŠ¨ç«¯æ˜¾ç¤ºèƒŒæ™¯
            if (window.innerWidth <= 768) {
                backdrop.classList.toggle('show');
            }
        }
        
        /**
         * åˆ‡æ¢è§†å›¾æ¨¡å¼
         * @param {string} view - è§†å›¾æ¨¡å¼ (grid/list)
         */
        function switchView(view) {
            console.log(`ğŸ‘ åˆ‡æ¢è§†å›¾ï¼š${view}`);
            
            AppState.currentView = view;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });
            
            // é‡æ–°æ¸²æŸ“
            renderTasks();
        }
        
        /**
         * æ˜¾ç¤ºåŠ è½½çŠ¶æ€
         */
        function showLoading() {
            document.getElementById('loadingContainer').classList.remove('hidden');
            document.getElementById('taskContainer').classList.add('hidden');
            document.getElementById('emptyState').classList.add('hidden');
        }
        
        /**
         * æ˜¾ç¤ºé”™è¯¯
         * @param {string} message - é”™è¯¯æ¶ˆæ¯
         */
        function showError(message) {
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('.empty-icon').textContent = 'âŒ';
            emptyState.querySelector('.empty-title').textContent = 'åŠ è½½å¤±è´¥';
            emptyState.querySelector('.empty-message').textContent = message;
            
            document.getElementById('loadingContainer').classList.add('hidden');
            document.getElementById('taskContainer').classList.add('hidden');
            emptyState.classList.remove('hidden');
        }
        
        /**
         * æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
         * @param {string} message - æ¶ˆæ¯å†…å®¹
         * @param {string} type - æ¶ˆæ¯ç±»å‹ (success/error/info)
         */
        function showToast(message, type = 'info') {
            // åˆ›å»ºæç¤ºå…ƒç´ 
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 24px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                z-index: 1000;
                animation: slideIn 0.3s ease;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            
            // æ ¹æ®ç±»å‹è®¾ç½®é¢œè‰²
            const colors = {
                success: '#34c759',
                error: '#ff3b30',
                info: '#007aff'
            };
            
            toast.style.backgroundColor = colors[type] || colors.info;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        /**
         * æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
         */
        function updateStats() {
            const statsEl = document.getElementById('headerStats');
            const total = AppState.allTasks.length;
            const filtered = AppState.filteredTasks.length;
            
            if (total === filtered) {
                statsEl.textContent = `å…± ${total} ä¸ªä»»åŠ¡`;
            } else {
                statsEl.textContent = `æ˜¾ç¤º ${filtered} / ${total} ä¸ªä»»åŠ¡`;
            }
        }
        
        // ==================== äº‹ä»¶å¤„ç† ====================
        
        /**
         * å¤„ç†é”®ç›˜å¿«æ·é”®
         * @param {KeyboardEvent} event - é”®ç›˜äº‹ä»¶
         */
        function handleKeyboardShortcuts(event) {
            // Cmd/Ctrl + R: åˆ·æ–°
            if ((event.metaKey || event.ctrlKey) && event.key === 'r') {
                event.preventDefault();
                refreshTasks();
            }
            
            // Cmd/Ctrl + F: èšç„¦æœç´¢ï¼ˆå¦‚æœæœ‰æœç´¢åŠŸèƒ½ï¼‰
            if ((event.metaKey || event.ctrlKey) && event.key === 'f') {
                event.preventDefault();
                // è¿™é‡Œå¯ä»¥å®ç°æœç´¢åŠŸèƒ½
            }
            
            // Esc: å…³é—­ä¾§è¾¹æ ï¼ˆç§»åŠ¨ç«¯ï¼‰
            if (event.key === 'Escape' && window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                if (!sidebar.classList.contains('collapsed')) {
                    toggleSidebar();
                }
            }
        }
        
        /**
         * å¤„ç†çª—å£å¤§å°å˜åŒ–
         */
        function handleResize() {
            // åœ¨å¤§å±å¹•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºä¾§è¾¹æ 
            if (window.innerWidth > 768) {
                const sidebar = document.getElementById('sidebar');
                const backdrop = document.getElementById('sidebarBackdrop');
                
                sidebar.classList.remove('collapsed');
                backdrop.classList.remove('show');
            }
        }
        
        // ==================== å·¥å…·å‡½æ•° ====================
        
        /**
         * è·å–çŠ¶æ€å›¾æ ‡
         * @param {string} status - ä»»åŠ¡çŠ¶æ€
         * @returns {string} çŠ¶æ€å›¾æ ‡
         */
        function getStatusIcon(status) {
            const icons = {
                'æœªå¼€å§‹': 'ğŸ”µ',
                'è¿›è¡Œä¸­': 'ğŸŸ¡',
                'å·²å®Œæˆ': 'ğŸŸ¢'
            };
            return icons[status] || 'âšª';
        }
        
        /**
         * è·å–ä¼˜å…ˆçº§å›¾æ ‡
         * @param {string} priority - ä¼˜å…ˆçº§
         * @returns {string} ä¼˜å…ˆçº§å›¾æ ‡
         */
        function getPriorityIcon(priority) {
            const icons = {
                'é«˜': 'ğŸ”´',
                'ä¸­': 'ğŸŸ¡',
                'ä½': 'ğŸŸ¢'
            };
            return icons[priority] || 'âšª';
        }
        
        /**
         * è·å–ä¸‹ä¸€ä¸ªçŠ¶æ€
         * @param {string} currentStatus - å½“å‰çŠ¶æ€
         * @returns {string} ä¸‹ä¸€ä¸ªçŠ¶æ€
         */
        function getNextStatus(currentStatus) {
            const statusFlow = {
                'æœªå¼€å§‹': 'è¿›è¡Œä¸­',
                'è¿›è¡Œä¸­': 'å·²å®Œæˆ',
                'å·²å®Œæˆ': 'æœªå¼€å§‹'
            };
            return statusFlow[currentStatus] || 'æœªå¼€å§‹';
        }
        
        /**
         * è·å–çŠ¶æ€æ“ä½œå›¾æ ‡
         * @param {string} status - å½“å‰çŠ¶æ€
         * @returns {string} æ“ä½œå›¾æ ‡
         */
        function getStatusActionIcon(status) {
            const icons = {
                'æœªå¼€å§‹': 'â–¶ï¸',
                'è¿›è¡Œä¸­': 'âœ…',
                'å·²å®Œæˆ': 'ğŸ”„'
            };
            return icons[status] || 'â–¶ï¸';
        }
        
        /**
         * è·å–çŠ¶æ€æ“ä½œæ–‡æœ¬
         * @param {string} status - å½“å‰çŠ¶æ€
         * @returns {string} æ“ä½œæ–‡æœ¬
         */
        function getStatusActionText(status) {
            const texts = {
                'æœªå¼€å§‹': 'å¼€å§‹',
                'è¿›è¡Œä¸­': 'å®Œæˆ',
                'å·²å®Œæˆ': 'é‡ç½®'
            };
            return texts[status] || 'æ›´æ–°';
        }
        
        /**
         * HTML è½¬ä¹‰
         * @param {string} text - åŸå§‹æ–‡æœ¬
         * @returns {string} è½¬ä¹‰åçš„æ–‡æœ¬
         */
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }
        
        /**
         * é˜²æŠ–å‡½æ•°
         * @param {Function} func - è¦é˜²æŠ–çš„å‡½æ•°
         * @param {number} wait - ç­‰å¾…æ—¶é—´
         * @returns {Function} é˜²æŠ–åçš„å‡½æ•°
         */
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // ==================== è°ƒè¯•è¾“å‡º ====================
        
        if (Config.debug) {
            console.log('%cğŸ¯ ä»Šæ—¥ä»»åŠ¡çœ‹æ¿å·²åŠ è½½', 
                       'color: #007aff; font-size: 16px; font-weight: bold;');
            console.log('å¯ç”¨çš„å…¨å±€å¯¹è±¡å’Œå‡½æ•°ï¼š');
            console.log('- AppState: åº”ç”¨çŠ¶æ€');
            console.log('- Config: é…ç½®é€‰é¡¹');
            console.log('- bridge: é€šä¿¡æ¡¥æ¥å®ä¾‹');
            console.log('- refreshTasks(): åˆ·æ–°ä»»åŠ¡');
            console.log('- toggleSidebar(): åˆ‡æ¢ä¾§è¾¹æ ');
            console.log('- switchView(view): åˆ‡æ¢è§†å›¾');
            console.log('- resetFilters(): é‡ç½®ç­›é€‰å™¨');
        }
    </script>
</body>
</html>